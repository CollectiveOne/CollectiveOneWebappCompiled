(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59061785"],{"0013":function(t,e,i){"use strict";var a=i("5ff3"),n=i.n(a);n.a},"0413":function(t,e,i){"use strict";var a=i("f158"),n=i.n(a);n.a},"14f4":function(t,e,i){},"16cf5":function(t,e,i){"use strict";var a=i("f130"),n=i.n(a);n.a},"1a80":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cards-container-list"},[t._l(t.cardWrappers,function(e,a){return i("div",{key:e.id,staticClass:"section-card",class:t.cardsContainerClasses,on:{dragover:function(i){i.preventDefault(),t.draggingOver(i,e)},drop:function(i){i.preventDefault(),t.cardDroped(e.id,i)}}},[t.isDraggingOver(e)&&t.draggingOverCardWrapperBefore?i("div",{staticClass:"drop-div"}):t._e(),i("div",{staticClass:"card-container-in-list"},[i("app-model-card",{attrs:{cardWrapperInit:e,inSection:t.inSection,type:t.cardsType,cardRouteName:t.cardRouteName,hideCardControls:t.hideCardControls},on:{edit:function(i){t.$emit("edit",e)},createNew:function(i){t.$emit("createNew",e)},updateCards:function(e){t.$emit("updateCards")}}})],1),t.isDraggingOver(e)&&t.draggingOverCardWrapperAfter?i("div",{staticClass:"drop-div"}):t._e()])}),!t.hideCardControls&&t.isLoggedAnEditor?i("div",{class:t.cardsContainerClasses,on:{dragover:function(e){e.preventDefault(),t.draggingOver()},drop:function(e){e.preventDefault(),t.cardDroped("",e)}}},[t.draggingOverCreateCard?i("div",{staticClass:"drop-div"}):t._e(),t.creatingNewCard?i("div",{staticClass:"card-container-in-list"},[i("app-model-card-editor",{attrs:{isNew:!0,inSection:t.inSection,type:t.cardsType},on:{edit:function(e){t.creatingNewCard=!1},updateCards:function(e){t.cardCreated()}}})],1):i("div",{},[i("popper",{attrs:{"append-to-body":!0,trigger:"click",options:t.popperOptions}},[i("app-drop-down-menu",{staticClass:"drop-menu",attrs:{items:t.newCardItems},on:{createNew:function(e){t.creatingNewCard=!0},addExisting:function(e){t.addExisting()}}}),i("button",{staticClass:"w3-button app-button-light new-card-button",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])],1)],1)]):t._e()],2)},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.cardWrapper?i("div",{staticClass:"card-base-div"},[i("div",{staticClass:"card-content-container",attrs:{draggable:t.$store.state.support.triggerCardDraggingState&&t.isDraggable},on:{dragstart:function(e){t.dragStart(e)}}},[i(t.cardComponent,{tag:"component",attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,forceUpdate:t.forceUpdate,inCardSelector:t.inCardSelector,isNew:"newCard"===t.cardWrapper.type,cardRouteName:t.cardRouteName,hideCardControls:t.hideCardControls,type:t.type},on:{update:function(e){t.update()},edit:function(e){t.$emit("edit")},setConsent:function(e){t.setConsent(e)},createNew:function(e){t.$emit("createNew")},updateCards:function(e){t.$emit("updateCards")}}}),i("transition",{attrs:{name:"fadeenter"}},[t.$store.state.support.triggerCardDraggingState?i("div",{staticClass:"cover-when-draggable"},[i("div",{staticClass:"cover-when-draggable-content"},[i("span",[i("i",{staticClass:"fa fa-arrows",attrs:{"aria-hidden":"true"}}),t._v(" move\n          ")])])]):t._e()])],1)]):t._e()},s=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"model-card-editor-container",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[a("div",{staticClass:"input-form",class:t.inputClass},[a("div",{staticClass:"image-row"},[t.hasImage||t.uploadingImage?a("div",{staticClass:"w3-row image-container w3-center w3-display-container"},[t.uploadingImage?a("div",{staticClass:"loader-gif-container"},[a("img",{staticClass:"loader-gif",attrs:{src:i("cf1c"),alt:""}})]):t._e(),t.uploadingImage?t._e():a("div",{},[t.hasImage?a("img",{attrs:{src:t.editedCard.imageFile.url+"?lastUpdated="+t.editedCard.imageFile.lastUpdated,alt:""},on:{click:function(e){t.showImageClick()}}}):t._e()]),t.uploadingImage?t._e():a("div",{staticClass:"w3-display-middle"},[a("input",{staticClass:"inputfile",attrs:{type:"file",name:"imageFile",id:"imageFile",accept:"image/*"},on:{change:function(e){t.newFileSelected(e)}}}),a("label",{staticClass:"w3-button app-button w3-rounded",attrs:{for:"imageFile"}},[t._v("\n            "+t._s(t.editedCard.imageFile?t.$t("general.CHANGE"):t.$t("general.UPLOAD_IMAGE"))+"\n          ")]),t.hasImage?a("button",{staticClass:"w3-button app-button-danger",on:{click:function(e){t.removeImage()}}},[t._v("\n            "+t._s(t.$t("general.REMOVE"))+"\n          ")]):t._e()])]):t._e(),a("app-error-panel",{attrs:{show:t.errorUploadingFile,message:t.errorUploadingFileMsg}})],1),a("div",{staticClass:"cursor-pointer editor-row"},[a("div",{staticClass:"w3-row input-border"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editedCard.title,expression:"editedCard.title"}],staticClass:"w3-input w3-hover-light-grey",attrs:{type:"text",placeholder:t.$t("model.TITLE")},domProps:{value:t.editedCard.title},on:{input:function(e){e.target.composing||t.$set(t.editedCard,"title",e.target.value)}}})]),a("div",{ref:"cardText",staticClass:"w3-row card-text"},[a("app-markdown-editor",{attrs:{placeholder:t.$t("model.CONTENT"),keepBackup:!1,showBorder:!1},model:{value:t.editedCard.text,callback:function(e){t.$set(t.editedCard,"text",e)},expression:"editedCard.text"}})],1)])]),a("div",{staticClass:"meta-row",class:t.controlsClass},[a("div",{staticClass:"controls-row"},[a("div",{staticClass:"w3-left scope-controls"},[a("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="COMMON"}}},[a("i",{staticClass:"fa fa-circle select-common highlight",attrs:{"aria-hidden":"true"}})]),a("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="SHARED"}}},[a("i",{staticClass:"fa fa-circle select-shared highlight",attrs:{"aria-hidden":"true"}})]),a("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="PRIVATE"}}},[a("i",{staticClass:"fa fa-circle select-private highlight",attrs:{"aria-hidden":"true"}})])]),a("div",{staticClass:"w3-left scope-text-div"},[t._v("\n         "+t._s(t.cardScopeText)+"\n      ")]),a("div",{staticClass:"w3-right control-buttons"},[t.hasImage?t._e():a("div",{staticClass:"w3-right cursor-pointer indicator-comp"},[a("input",{staticClass:"inputfile",attrs:{type:"file",name:"imageFile",id:"imageFile",accept:"image/*"},on:{change:function(e){t.newFileSelected(e)}}}),t._m(0)]),t.isNew?t._e():a("div",{staticClass:"w3-right cursor-pointer w3-margin-right",on:{click:function(e){t.expandCard()}}},[a("i",{staticClass:"fa fa-expand highlight",attrs:{"aria-hidden":"true"}})])])]),a("div",{staticClass:"button-row send-button-container"},[a("div",{staticClass:"w3-row"},[a("div",{staticClass:"w3-col m6"},[a("button",{staticClass:"w3-button app-button-light",attrs:{name:"button"},on:{click:function(e){t.$emit("edit",null)}}},[t._v("\n            "+t._s(t.$t("general.CANCEL"))+"\n          ")])]),a("div",{staticClass:"w3-col m6"},[a("button",{directives:[{name:"show",rawName:"v-show",value:!t.sendingData,expression:"!sendingData"}],staticClass:"w3-button app-button",attrs:{name:"button"},on:{click:function(e){t.createCard()}}},[t._v("\n            "+t._s(t.cardButtonText)+"\n          ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.sendingData,expression:"sendingData"}],staticClass:"sending-accept light-grey w3-center"},[a("img",{attrs:{src:i("cf1c"),alt:""}})])])]),a("div",{staticClass:"w3-row"},[a("app-error-panel",{attrs:{show:t.errorCreatingCard,message:t.errorCreatingCardMessage}})],1)])])])},c=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{staticClass:"cursor-pointer",attrs:{for:"imageFile"}},[i("i",{staticClass:"fa fa-picture-o highlight",attrs:{"aria-hidden":"true"}})])}],d=i("b968"),l={components:{"app-model-card-link":d["a"]},props:{cardWrapper:{type:Object,default:null},forceUpdate:{type:Boolean,default:!0},inSection:{type:Object,default:null},hideCardControls:{type:Boolean,default:!1},inCardSelector:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},computed:{originCardWrapperAdditions:function(){return this.cardWrapper?this.cardWrapper.originCardWrapperAdditions:[]},hasOrigin:function(){return this.originCardWrapperAdditions.length>0},cardWrapperId:function(){return this.cardWrapper?this.cardWrapper.id:""},isPrivate:function(){return"PRIVATE"===this.cardWrapper.scope},isShared:function(){return"SHARED"===this.cardWrapper.scope},inSectionId:function(){return this.inSection?this.inSection.id:""},isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},alsoInSections:function(){var t=this;return this.cardWrapper.inModelSections.filter(function(e){return t.inSection.id!==e.id})},containerClass:function(){var t={};switch(this.cardWrapper.scope){case"PRIVATE":t["border-red"]=!0;break;case"SHARED":t["border-yellow"]=!0;break;case"COMMON":t["border-blue"]=!0;break;default:t["border-gray"]=!0;break}return t},showLikes:function(){return!this.isPrivate&&!this.governanceTypeIsConsent},showConsentPositions:function(){return!this.isPrivate&&this.governanceTypeIsConsent},governanceTypeIsConsent:function(){return"SIMPLE_CONSENT"===this.cardWrapper.governanceType},consentIsOpened:function(){return"OPENED"===this.cardWrapper.simpleConsentState}},methods:{cardClicked:function(){this.inCardSelector||this.$router.push({name:this.cardRouteName,params:{cardId:this.cardWrapperId}})},editors:function(){var t=[];for(var e in this.cardWrapper.editors)this.cardWrapper.editors[e].c1Id!==this.cardWrapper.creator.c1Id&&t.push(this.cardWrapper.editors[e]);return t}}},p=i("d5b4"),u={name:"model-card-as-card",mixins:[l],components:{"app-in-model-sections-tags":p["a"]},props:{isNew:{type:Boolean,default:!1},inSection:{type:Object,default:null},cardWrapper:{type:Object,default:null},type:{type:String,default:"card"}},data:function(){return{editing:!0,editedCard:{title:"",text:"",newScope:"COMMON"},hovering:!1,showFull:!1,addExisting:!1,sendingData:!1,loading:!1,scope:"COMMON",uploadingImage:!1,errorUploadingFile:!1,errorUploadingFileMsg:"",errorCreatingCard:!1,errorCreatingCardMessage:""}},computed:{titleEmpty:function(){return!!this.editedCard&&""===this.editedCard.title},titleTooLong:function(){return!!this.editedCard&&this.editedCard.title.length>42},textEmpty:function(){return!!this.editedCard&&""===this.editedCard.text},textErrorShow:function(){return this.textEmptyError&&this.textEmpty},noCardSelected:function(){return null===this.existingCard},noCardSelectedShow:function(){return this.noCardSelectedError&&this.noCardSelected},titleErrorShow:function(){return this.titleEmptyShow||this.titleTooLongShow},titleEmptyShow:function(){return this.titleEmptyError&&this.titleEmpty},titleTooLongShow:function(){return this.titleTooLong},atCardWrapper:function(){return null===this.cardWrapper?null:this.cardWrapper.cardWrapper},cardWrapperIdForImage:function(){return this.isNew?"":this.atCardWrapper.id},newCardLocation:function(){return"before"===this.$store.state.support.createNewCardLocation},cardButtonText:function(){return this.isNew?this.$t("general.CREATE"):this.$t("general.SAVE")},hasImage:function(){return null!=this.editedCard.imageFile},containerClass:function(){var t={};return t["border-red"]="PRIVATE"===this.scope,t["border-yellow"]="SHARED"===this.scope,t["border-blue"]="COMMON"===this.scope,t["w3-card-4 w3-topbar w3-round-large"]="card"===this.type,t["card-summary-container w3-leftbar w3-card w3-row"]="summary"===this.type,t["card-editor-doc"]="doc"===this.type,t},inputClass:function(){var t={};return t["w3-row card-container cursor-pointer limit-height"]="card"===this.type,t["w3-col m8 left-div"]="summary"===this.type,t["w3-row w3-col s12"]="doc"===this.type,t},controlsClass:function(){var t={};return t["w3-row bottom-row light-grey"]="card"===this.type,t["w3-col m4 right-div-top controls w3-display-bottom"]="summary"===this.type,t},card:function(){return this.atCardWrapper.card},cardScopeText:function(){switch(this.scope){case"PRIVATE":return this.$t("model.PRIVATE");case"SHARED":return this.$t("model.SHARED");case"COMMON":return this.$t("model.COMMON")}return""}},methods:{expandCard:function(){this.inCardSelector||this.$router.push({name:this.cardRouteName,params:{cardId:this.cardWrapperIdForImage}})},removeImage:function(){this.editedCard.imageFile=null,this.editedCard.newImageFileId="REMOVE"},newFileSelected:function(t){var e=this,i=t.target.files[0];if(i.size>1048576)return this.errorUploadingFile=!0,void(this.errorUploadingFileMsg="Image file too big. Must be below 1 MB");var a=new FormData;a.append("file",i),this.uploadingImage=!0,this.errorUploadingFile=!1,this.axios.post("/1/upload/cardImage/"+this.cardWrapperIdForImage,a).then(function(t){if(console.log(t),e.uploadingImage=!1,"success"===t.data.result)return e.editedCard.newImageFileId=t.data.elementId,e.axios.get("/1/files/"+e.editedCard.newImageFileId);e.errorUploadingFile=!0,e.errorUploadingFileMsg=t.data.message}).then(function(t){var i=JSON.parse(JSON.stringify(e.editedCard));i.imageFile=t.data.data,e.editedCard=i})},showImageClick:function(){this.editing||(this.showImage=!0)},startEditing:function(){this.editedCard=JSON.parse(JSON.stringify(this.atCardWrapper.card)),this.scope=this.atCardWrapper.scope},textTooLong:function(){return!!this.$refs.cardText&&(this.$refs.cardText.scrollHeight>250||this.$refs.cardText.clientHeight<this.$refs.cardText.scrollHeight)},hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1},createCard:function(){var t=this,e=!0;if(this.addExisting?this.noCardSelected&&(e=!1,this.noCardSelectedError=!0):this.titleTooLong&&(e=!1),e){this.editedCard.newScope=this.scope;var i=JSON.parse(JSON.stringify(this.editedCard));this.isNew?this.addExisting||(this.sendingData=!0,this.axios.post("/1/model/section/"+this.inSection.id+"/cardWrapper",i,{params:{onCardWrapperId:this.atCardWrapper?this.atCardWrapper.id:null,isBefore:this.newCardLocation}}).then(function(e){t.sendingData=!1,"success"===e.data.result?t.$emit("updateCards"):(t.errorCreatingCard=!0,t.errorCreatingCardMessage=e.data.message)}).catch(function(t){console.log(t)})):(console.log("editing",this.inSection.id,this.type,this.atCardWrapper.id,this.scope,i),this.sendingData=!0,this.axios.put("/1/model/cardWrapper/"+this.atCardWrapper.id,i,{params:{inSectionId:this.inSection.id}}).then(function(e){console.log(e),t.sendingData=!1,"success"===e.data.result&&(t.$emit("updateCards"),t.$emit("edit",null))}).catch(function(t){console.log(t)}))}},atKeydown:function(t){this.editing&&(27===t.keyCode&&this.$emit("edit"),13===t.keyCode&&t.ctrlKey&&(t.preventDefault(),this.createCard()))}},mounted:function(){this.isNew?(this.editedCard={title:"",text:"",newScope:"SHARED"},this.editing=!0):this.startEditing(),window.addEventListener("keydown",this.atKeydown)},destroyed:function(){window.removeEventListener("keydown",this.atKeydown)}},h=u,f=(i("a5c2"),i("2877")),g=Object(f["a"])(h,o,c,!1,null,"7b908b47",null);g.options.__file="ModelCardEditor.vue";var C=g.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-summary-container w3-leftbar w3-card w3-row",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[i("div",{staticClass:"w3-col m8 left-div"},[t.inCardSelector?t._e():i("div",{staticClass:"w3-left expand-btn cursor-pointer",on:{click:function(e){t.cardClicked()}}},[i("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}})]),i("div",{staticClass:"w3-left text-div"},[t._v("\n      "+t._s(t.cardShortTitle)+"\n    ")]),t.cardWrapper.inModelSections.length>0&&!t.hideCardControls?i("div",{staticClass:"w3-right text-div"},[i("app-in-model-sections-tags",{attrs:{inModelSections:t.cardWrapper.inModelSections,hideSectionId:t.inSectionId}})],1):t._e()]),i("div",{staticClass:"w3-col m4 right-div"},[t.inCardSelector?t._e():i("div",{},[i("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName,hideInSectionTags:!0},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1)])])},v=[],w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"user-indicators-container"},[t.hasOrigin?i("div",{staticClass:"origin-row w3-row"},[i("i",[t._v(t._s(t.$t("model.ORIGIN"))+":")]),i("app-model-card-link",{attrs:{cardWrapper:t.originCardWrapperAdditions[0].cardWrapper,onSection:t.originCardWrapperAdditions[0].section}}),t._v(" "+t._s(t.$t("general.IN"))+"\n    "),t._l(t.originCardWrapperAdditions,function(t){return i("app-model-section-tag",{key:t.id,staticClass:"on-origin-section",attrs:{section:t.section}})})],2):t._e(),i("div",{staticClass:"common-row w3-row",class:{"common-row-with-gov":t.showConsentPositions}},[i("div",{staticClass:"w3-left"},[null!==t.cardWrapper.creator?i("div",{staticClass:"w3-left text-div"},[i("app-user-avatar",{attrs:{user:t.cardWrapper.creator,showName:!1,small:!0}})],1):t._e(),t.editors.length>0?i("div",{staticClass:"w3-left editors-div"},t._l(t.editors,function(e){return i("div",{staticClass:"w3-left"},[e.c1Id!==t.cardWrapper.creator.c1Id?i("app-user-avatar",{attrs:{user:e,showName:!1,small:!0}}):t._e()],1)})):t._e(),t.alsoInSections.length>0&&!t.hideCardControls&&!t.hideInSectionTags?i("div",{staticClass:"w3-margin-left w3-left"},[i("app-in-model-sections-tags",{attrs:{inModelSections:t.alsoInSections}})],1):t._e()]),i("div",{staticClass:"w3-right"},[i("div",{staticClass:"w3-right"},[i("app-notifications-list",{attrs:{element:t.cardWrapper,contextType:"MODEL_CARD"}})],1),!t.hideCardControls&&this.isLoggedAnEditor?i("div",{staticClass:"w3-right gray-1-color control-div"},[i("app-card-control-buttons",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,showDetach:t.alsoInSections.length>0},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},startConsent:function(e){t.$emit("setConsent",!0)},stopConsent:function(e){t.$emit("setConsent",!1)},updateCards:function(e){t.$emit("updateCards")}}})],1):t._e(),t.isPrivate?t._e():i("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.cardClicked()}}},[i("app-indicator",{attrs:{contextType:"MODEL_CARD",contextElementId:t.cardWrapper.id,size:18,type:"messages",forceUpdate:t.forceUpdate}})],1),t.showLikes?i("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.toggleLike()}}},[i("app-indicator",{attrs:{contextType:"MODEL_CARD",contextElementId:t.cardWrapper.id,size:18,type:"likes",selected:t.cardWrapper.userLiked,autoUpdate:!1,countInit:t.cardWrapper.nLikes}})],1):t._e()])]),t.showConsentPositions?i("div",{staticClass:"governance-row w3-row"},[i("app-consent-positions",{attrs:{elementId:t.cardWrapper.additionId,ownPosition:t.cardWrapper.ownPosition,disabled:!t.consentIsOpened},on:{update:function(e){t.$emit("update")}}})],1):t._e()])},S=[],b=(i("cadf"),i("551c"),i("097d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("div",{staticClass:"modals"},[i("div",{staticClass:"slider-container"},[i("transition",{attrs:{name:"slideDownUp"}},[t.showNewCardModal?i("app-model-card-modal",{attrs:{isNew:!0,inSectionId:t.inSection.id,inSectionTitle:t.inSection.title,atCardWrapper:t.cardWrapper,newCardLocation:t.newCardLocation},on:{close:function(e){t.showNewCardModal=!1},update:function(e){t.$emit("update")},updateCards:function(e){t.$emit("updateCards")}}}):t._e()],1),i("transition",{attrs:{name:"slideDownUp"}},[t.showEditCardModal?i("app-model-card-modal",{attrs:{isNew:!1,cardWrapperId:t.cardWrapper.id,inSectionId:t.inSection.id,inSectionTitle:t.inSection.title,editingInit:!0},on:{close:function(e){t.showEditCardModal=!1},update:function(e){t.$emit("update")}}}):t._e()],1)],1)]),i("popper",{attrs:{"append-to-body":!0,trigger:"click",options:t.popperOptions,toggleShow:t.togglePopperShow}},[i("div",{},[i("app-drop-down-menu",{staticClass:"drop-menu",attrs:{items:t.menuItems},on:{edit:function(e){t.edit()},detach:function(e){t.detachIntent=!0},startConsent:function(e){t.startConsent()},stopConsent:function(e){t.stopConsent()},addCardBefore:function(e){t.addCardLocation("before")},addCardAfter:function(e){t.addCardLocation("after")},remove:function(e){t.remove()}}}),i("div",{staticClass:"w3-card w3-white drop-menu"},[t.detachIntent?i("div",{staticClass:"w3-row w3-center delete-intent-div"},[i("div",{staticClass:"w3-padding w3-round light-grey w3-margin-bottom"},[i("p",{domProps:{innerHTML:t._s(t.$t("model.DETACH_CARD_WARNING"))}})]),i("button",{staticClass:"w3-button light-grey",on:{click:function(e){t.detachIntent=!1}}},[t._v(t._s(t.$t("general.CANCEL"))+"\n          ")]),i("button",{staticClass:"w3-button button-blue",on:{click:function(e){t.detachConfirmed()}}},[t._v(t._s(t.$t("general.CONFIRM"))+"\n          ")])]):t._e(),t.removeIntent?i("div",{staticClass:"w3-row w3-center delete-intent-div"},[i("div",{staticClass:"w3-padding w3-round light-grey w3-margin-bottom"},[i("p",{domProps:{innerHTML:t._s(t.$t("model.REMOVE_CARD_WARNING",{title:t.inSection.title}))}})]),i("button",{staticClass:"w3-button light-grey",on:{click:function(e){t.removeIntent=!1}}},[t._v(t._s(t.$t("general.CANCEL"))+"\n          ")]),i("button",{staticClass:"w3-button button-blue",on:{click:function(e){t.removeConfirmed()}}},[t._v(t._s(t.$t("general.CONFIRM"))+"\n          ")])]):t._e()])],1),i("div",{staticClass:"expand-btn cursor-pointer",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])])],1)}),y=[],I={props:{cardWrapper:{type:Object,default:null},inSection:{type:Object,deafult:null},showDetach:{type:Boolean,default:!1}},data:function(){return{showNewCardModal:!1,newCardLocation:"end",showEditCardModal:!1,detachIntent:!1,removeIntent:!1,togglePopperShow:!1}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},isPrivate:function(){return"PRIVATE"===this.cardWrapper.scope},isShared:function(){return"SHARED"===this.cardWrapper.scope},isLoggedTheAuthor:function(){return this.cardWrapper.creator.c1Id===this.$store.state.user.profile.c1Id},isConsent:function(){return"SIMPLE_CONSENT"===this.cardWrapper.governanceType},isConsentOpened:function(){return"OPENED"===this.cardWrapper.simpleConsentState},menuItems:function(){var t=[];switch(this.cardWrapper.scope){case"PRIVATE":case"SHARED":this.isLoggedTheAuthor&&t.push({text:this.$t("general.EDIT"),value:"edit",faIcon:"fa-pencil"});break;case"COMMON":this.isLoggedAnEditor&&(t.push({text:this.$t("general.EDIT"),value:"edit",faIcon:"fa-pencil"}),this.showDetach&&t.push({text:this.$t("model.DETACH_LC"),value:"detach",faIcon:"fa-chain-broken"}));break}return this.isLoggedAnEditor&&t.push({text:this.$t("model.ADD_CARD_BEFORE"),value:"addCardBefore",faIcon:"fa-plus"}),this.isLoggedAnEditor&&t.push({text:this.$t("model.ADD_CARD_AFTER"),value:"addCardAfter",faIcon:"fa-plus"}),this.isLoggedAnEditor&&!this.isConsent?t.push({text:this.$t("model.START_CONSENT"),value:"startConsent",faIcon:"fa-users"}):this.isConsentOpened?t.push({text:this.$t("model.STOP_CONSENT"),value:"stopConsent",faIcon:"fa-users"}):t.push({text:this.$t("model.REOPEN_CONSENT"),value:"startConsent",faIcon:"fa-users"}),this.isLoggedAnEditor&&t.push({text:this.$t("general.REMOVE"),value:"remove",faIcon:"fa-times"}),t},popperOptions:function(){return{placement:"bottom",modifiers:{preventOverflow:{enabled:!1}}}}},methods:{startConsent:function(){this.togglePopperShow=!this.togglePopperShow,this.$emit("startConsent")},stopConsent:function(){this.togglePopperShow=!this.togglePopperShow,this.$emit("stopConsent")},addCardLocation:function(t){this.$store.commit("createNewCardLocation",t),this.$emit("createNew"),this.togglePopperShow=!this.togglePopperShow},edit:function(){this.$emit("edit"),this.togglePopperShow=!this.togglePopperShow},remove:function(){this.removeIntent=!0},detachConfirmed:function(){var t=this;this.axios.put("/1/model/section/"+this.inSection.id+"/detachCardWrapper/"+this.cardWrapper.id,{}).then(function(e){console.log(e),"success"===e.data.result?(t.detachIntent=!1,t.togglePopperShow=!t.togglePopperShow,t.$emit("updateCards")):t.showOutputMessage(e.data.message)}).catch(function(t){console.log(t)})},removeConfirmed:function(){var t=this;this.axios.put("/1/model/section/"+this.inSection.id+"/removeCard/"+this.cardWrapper.id,{}).then(function(e){console.log(e),"success"===e.data.result?(t.removeIntent=!1,t.togglePopperShow=!t.togglePopperShow,t.$emit("updateCards")):t.showOutputMessage(e.data.message)}).catch(function(t){console.log(t)})}},mounted:function(){},destroyed:function(){}},_=I,E=(i("0413"),Object(f["a"])(_,b,y,!1,null,"2f23f4b3",null));E.options.__file="CardControlButtons.vue";var O=E.exports,N=i("f868"),W=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"w3-row positions-container"},[i("popper",{staticClass:"w3-left",attrs:{trigger:"click",options:t.popperOptions,toggleShow:t.toggleShowPopper,disabled:t.disabled}},[i("div",{staticClass:"position-selector w3-card w3-white"},[i("div",{staticClass:"w3-row"},[t._v("\n        "+t._s(t.$t("model.MY_POSITION_ON_CARD"))+":\n      ")]),i("div",{staticClass:"w3-row w3-margin-top"},[i("div",{staticClass:"w3-left position-tag position-tag-green tag-margin",on:{click:function(e){t.setOwnPosition("GREEN")}}},[t._v("\n          "+t._s(t.$t("model.SUPPORT"))+"\n        ")]),i("div",{staticClass:"w3-left position-tag position-tag-yellow tag-margin",on:{click:function(e){t.setOwnPosition("YELLOW")}}},[t._v("\n          "+t._s(t.$t("model.UNDECIDED"))+"\n        ")]),i("div",{staticClass:"w3-left position-tag position-tag-red",on:{click:function(e){t.setOwnPosition("RED")}}},[t._v("\n          "+t._s(t.$t("model.OBJECT"))+"\n        ")])])]),i("div",{staticClass:"cursor-pointer avatar-position",class:t.getBorderClass(t.ownPosition),attrs:{slot:"reference"},slot:"reference"},[i("app-user-avatar",{attrs:{user:t.$store.state.user.profile,showName:!1,small:!0,enableHover:!1}})],1)]),t.othersPositions.length>0?i("div",{staticClass:"vertical-separator w3-left"}):t._e(),t._l(t.othersPositions,function(e){return i("div",{key:e.id,staticClass:"w3-left avatar-position",class:t.getBorderClass(e.positionColor)},[i("app-user-avatar",{attrs:{user:e.author,showName:!1,small:!0}})],1)}),t.disabled?i("div",{staticClass:"cover-div cover-div-closed"},[i("b",[t._v(t._s(t.$t("model.CLOSED")))])]):i("div",{staticClass:"cover-div cover-div-open"},[i("b",[t._v(t._s(t.$t("model.OPEN")))])])],2)},T=[],x={props:{elementId:{type:String},ownPosition:{type:String,default:null},disabled:{type:Boolean,default:!1}},data:function(){return{positions:[],toggleShowPopper:!1}},computed:{hasOwnPosition:function(){return null!=this.ownPosition},othersPositions:function(){var t=this;return this.positions.filter(function(e){return e.author.c1Id!==t.$store.state.user.profile.c1Id})},popperOptions:function(){return{placement:"right",modifiers:{preventOverflow:{enabled:!0,boundariesElement:"viewport"}}}}},methods:{getBorderClass:function(t){switch(t){case"GREEN":return{"avatar-border-green":!0};case"YELLOW":return{"avatar-border-yellow":!0};case"RED":return{"avatar-border-red":!0}}},updatePositions:function(){var t=this;this.axios.get("/1/model/cardAddition/"+this.elementId+"/consentPositions",{params:{elementType:"CARD_WRAPPER_ADDITION"}}).then(function(e){t.positions=e.data.data})},setOwnPosition:function(t){var e=this;this.toggleShowPopper=!this.toggleShowPopper,this.axios.put("/1/model/cardAddition/"+this.elementId+"/consentPosition",{},{params:{consentPosition:t,elementType:"CARD_WRAPPER_ADDITION"}}).then(function(t){e.$emit("update")})}},mounted:function(){this.updatePositions()}},$=x,A=(i("4d72"),Object(f["a"])($,W,T,!1,null,"7206887d",null));A.options.__file="ConsentPositions.vue";var k=A.exports,M={mixins:[l],components:{"app-card-control-buttons":O,"app-in-model-sections-tags":p["a"],"app-notifications-list":N["a"],"app-consent-positions":k},props:{hideInSectionTags:{type:Boolean,default:!1}},data:function(){return{forceConsentUpdate:!1}},computed:{stateIsRed:function(){return!!this.cardWrapper.semaphoreState&&"RED"===this.cardWrapper.semaphoreState},stateIsYellow:function(){return!!this.cardWrapper.semaphoreState&&"YELLOW"===this.cardWrapper.semaphoreState},stateIsGreen:function(){return!!this.cardWrapper.semaphoreState&&"GREEN"===this.cardWrapper.semaphoreState}},methods:{toggleLike:function(){var t=this;this.axios.put("/1/model/card/"+this.cardWrapper.id+"/like",{},{params:{likeStatus:!this.cardWrapper.userLiked}}).then(function(e){t.$emit("update")})}}},D=M,L=(i("16cf5"),Object(f["a"])(D,w,S,!1,null,"596fd6b7",null));L.options.__file="CardUserIndicators.vue";var P=L.exports,R={name:"model-card-summary",mixins:[l],components:{"app-in-model-sections-tags":p["a"],"app-card-user-indicators":P},props:{},data:function(){return{hovering:!1}},computed:{cardShortTitle:function(){return""!==this.card.title?this.card.title:this.card.text?this.card.text.length<40?this.card.text:this.card.text.slice(0,40)+"...":""},card:function(){return this.cardWrapper.card},hasImage:function(){return null!==this.card.imageFile}},methods:{hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1}},created:function(){}},U=R,B=(i("c335"),Object(f["a"])(U,m,v,!1,null,"5911aee3",null));B.options.__file="ModelCardSummary.vue";var F=B.exports,H=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"w3-display-container w3-card-4 w3-topbar w3-round-large",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[i("div",{staticClass:"card-content-container",class:{"limit-height":!t.showFull}},[i("div",{ref:"cardContent"},[i("app-model-card-as-card-content",{attrs:{card:t.card,showFull:t.showFull},on:{"card-clicked":function(e){t.cardClicked()}}})],1)]),i("div",{staticClass:"w3-row bottom-row light-grey"},[t.textTooLong?i("div",{staticClass:"expand-height-button"},[i("div",{staticClass:"w3-padding gray-2-color cursor-pointer",on:{click:function(e){t.showMoreClick()}}},[i("i",{staticClass:"fa fa-arrows-v",attrs:{"aria-hidden":"true"}})])]):t._e(),t.inCardSelector?t._e():i("div",{staticClass:"w3-row"},[i("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1)]),i("transition",{attrs:{name:"fadeenter"}},[t.hovering&&!t.inCardSelector?i("div",{staticClass:"w3-padding gray-2-color w3-display-topright cursor-pointer",on:{click:function(e){t.cardClicked()}}},[i("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}})]):t._e()])],1)},j=[],V=i("6f47"),J={name:"model-card-as-card",mixins:[l],components:{"app-card-user-indicators":P,"app-model-card-as-card-content":V["a"]},props:{},data:function(){return{hovering:!1,showFull:!1,textTooLong:!1}},computed:{card:function(){return this.cardWrapper.card}},methods:{checkTextTooLong:function(){this.$refs.cardContent||(this.textTooLong=!1),console.log(this.$refs.cardContent.scrollHeight),this.$refs.cardContent.scrollHeight>250?this.textTooLong=!0:this.textTooLong=this.$refs.cardContent.clientHeight<this.$refs.cardContent.scrollHeight},hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1},showMoreClick:function(){this.showFull=!this.showFull}},mounted:function(){var t=this;this.$nextTick(function(){t.checkTextTooLong()})}},G=J,Y=(i("5bc9"),Object(f["a"])(G,H,j,!1,null,"60fc2661",null));Y.options.__file="ModelCardAsCard.vue";var z=Y.exports,K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-container-doc",on:{mouseover:function(e){t.mouseOver()},mouseleave:function(e){t.mouseLeave()}}},[i("div",{staticClass:"w3-row"},[i("div",{staticClass:"w3-col s12"},[i("div",{class:t.containerClassPar,on:{click:function(e){t.clicked=!1}}},[""!==t.card.title?i("div",{staticClass:"w3-row card-title"},[t._v("\n          "+t._s(t.card.title)+"\n        ")]):t._e(),i("div",{ref:"cardText",staticClass:"w3-row card-text"},[t.card.text?i("vue-markdown",{staticClass:"marked-text",attrs:{source:t.card.text,anchorAttributes:{target:"_blank"}}}):t._e()],1)]),t.hasImage?i("div",{staticClass:"w3-row w3-center w3-display-container image-container"},[i("img",{attrs:{src:t.card.imageFile.url+"?lastUpdated="+t.card.imageFile.lastUpdated,alt:""}})]):t._e(),t.$store.state.user.authenticated?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.clickOutside,expression:"clickOutside"}]},[i("transition",{attrs:{name:"fadeenter"}},[t.clicked?i("div",{staticClass:"user-indicators-div w3-card-2 w3-white"},[i("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1):i("div",{staticClass:"expand-button gray-1-color",on:{click:function(e){t.clicked=!0}}},[i("i",{staticClass:"fa fa-ellipsis-v",attrs:{"aria-hidden":"true"}})])])],1):t._e()])])])},q=[],Q={name:"model-card-as-par",mixins:[l],components:{"app-card-user-indicators":P},props:{cardWrapper:{type:Object,default:null},forceUpdate:{type:Boolean,default:!0},inSection:{type:Object,default:null}},data:function(){return{hovering:!1,clicked:!1}},computed:{card:function(){return this.cardWrapper.card},hasImage:function(){return null!==this.card.imageFile},containerClassPar:function(){var t=this.containerClass;return t["card-container-padded"]=!this.hideCardControls,t}},methods:{clickOutside:function(){this.clicked=!1},mouseOver:function(){},mouseLeave:function(){}},mounted:function(){}},X=Q,Z=(i("8ba1"),i("ff0c"),Object(f["a"])(X,K,q,!1,null,"92035d1c",null));Z.options.__file="ModelCardAsPar.vue";var tt=Z.exports,et={name:"model-card",components:{"app-model-card-editor":C,"app-model-card-summary":F,"app-model-card-as-card":z,"app-model-card-as-par":tt},props:{cardWrapperInit:{type:Object,default:null},inSection:{type:Object,default:null},type:{type:String,default:"card"},forceUpdate:{type:Boolean,default:!0},inCardSelector:{type:Boolean,default:!1},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},watch:{cardWrapperInit:function(){this.cardWrapper=this.cardWrapperInit}},data:function(){return{cardWrapper:null}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},authorIsLoggedUser:function(){return!!this.$store.state.user.profile&&this.$store.state.user.profile.c1Id===this.cardWrapper.creator.c1Id},isDraggable:function(){return"COMMON"===this.cardWrapper.scope?this.isLoggedAnEditor:this.authorIsLoggedUser},cardComponent:function(){if("newCard"===this.cardWrapper.type||"edit"===this.cardWrapper.type||"new"===this.type)return"app-model-card-editor";switch(this.type){case"summary":return"app-model-card-summary";case"card":return"app-model-card-as-card";case"doc":return"app-model-card-as-par";default:return"app-model-card-as-card"}}},methods:{update:function(){var t=this;console.log("updating card "+this.cardWrapper.id),this.axios.get("/1/model/cardWrapperAddition/"+this.cardWrapper.id,{params:{inSectionId:this.inSection?this.inSection.id:""}}).then(function(e){t.cardWrapper=e.data.data})},setConsent:function(t){var e=this;this.axios.put("/1/model/cardAddition/"+this.cardWrapper.additionId+"/setConsent",{},{params:{elementType:"CARD_WRAPPER_ADDITION",simpleConsentState:t?"OPENED":"CLOSED"}}).then(function(t){e.update(),e.$emit("updateCards")})},dragStart:function(t){var e={type:"MOVE_CARD",cardWrapperId:this.cardWrapper.id,fromSectionId:this.inSection.id,scope:this.cardWrapper.scope};t.dataTransfer.setData("text/plain",JSON.stringify(e));var i={type:"MOVE_CARD",cardWrapper:this.cardWrapper,fromSection:this.inSection};this.$store.commit("setDraggingElement",i)}},created:function(){this.cardWrapper=this.cardWrapperInit}},it=et,at=(i("0013"),i("542b"),Object(f["a"])(it,r,s,!1,null,"716cb7c0",null));at.options.__file="ModelCard.vue";var nt=at.exports,rt={components:{"app-model-card":nt,"app-model-card-editor":C},props:{cardWrappers:{type:Array,default:function(){return[]}},inSection:{type:Object,default:null},cardsType:{type:String,default:"new"},acceptDrop:{type:Boolean,default:!1},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},cardsContainerClasses:function(){return{"section-card-col-with-nav":"card"===this.cardsType&&this.$store.state.support.expandModelNav&&!this.$store.state.support.windowIsSmall,"section-card-col-no-nav":"card"===this.cardsType&&(!this.$store.state.support.expandModelNav||this.$store.state.support.windowIsSmall),"section-card-par":"card"!==!this.cardsType}},draggingElement:function(){return this.$store.state.support.draggingElement},lastCardWrapper:function(){var t={cardWrapper:this.cardWrappers[this.cardWrappers.length-1]};return t},newCardItems:function(){var t=[];return t.push({text:"create new",value:"createNew",faIcon:"fa-plus"}),t.push({text:"add existing",value:"addExisting",faIcon:"fa-plus"}),t},popperOptions:function(){return{placement:"right",modifiers:{preventOverflow:{enabled:!1}}}}},data:function(){return{creatingNewCard:!1,draggingOverCardWrapper:null,draggingOverCreateCard:!1,draggingOverCardWrapperBefore:!1,draggingOverCardWrapperAfter:!1,resetIntervalId:0}},methods:{cardCreated:function(){this.creatingNewCard=!1,this.$emit("updateCards")},addExisting:function(){this.$emit("create-card",{addExistingInit:!0})},draggingOver:function(t,e){var i=this;if(this.acceptDrop){this.draggingOverCreateCard=null==e,"COMMON"===this.draggingElement.cardWrapper.scope&&"COMMON"===e.scope||"COMMON"!==this.draggingElement.cardWrapper.scope||null==this.draggingElement?this.draggingOverCardWrapper=e:this.draggingOverCardWrapper=null;var a=(t.screenY-t.currentTarget.getBoundingClientRect().top-100)/t.currentTarget.offsetHeight;a<.5?"COMMON"!==this.draggingElement.cardWrapper.scope&&"COMMON"===e.scope?(this.draggingOverCardWrapper=null,this.draggingOverCardWrapperBefore=!1,this.draggingOverCardWrapperAfter=!1):(this.draggingOverCardWrapperBefore=!0,this.draggingOverCardWrapperAfter=!1):(this.draggingOverCardWrapperBefore=!1,this.draggingOverCardWrapperAfter=!0),clearTimeout(this.resetIntervalId),this.resetIntervalId=setTimeout(function(){i.draggingOverCardWrapper=null,i.draggingOverCreateCard=!1},500)}},isDraggingOver:function(t){return!!this.acceptDrop&&(!!this.draggingOverCardWrapper&&this.draggingOverCardWrapper.id===t.id)},cardDroped:function(t,e){var i=this;if(this.acceptDrop){var a=JSON.parse(e.dataTransfer.getData("text/plain"));if("MOVE_CARD"===a.type){var n=!1;n=!e.ctrlKey&&""!==a.fromSectionId,n?(console.log("moving card "+a.cardWrapperId+" from "+a.fromSectionId+" to "+this.inSection.id),this.axios.put("/1/model/section/"+a.fromSectionId+"/moveCard/"+a.cardWrapperId,{},{params:{onSectionId:this.inSection.id,onCardWrapperId:t,isBefore:this.draggingOverCardWrapperBefore}}).then(function(t){i.$store.commit("triggerUpdateSectionCards")})):(console.log("adding card "+a.cardWrapperId+" to "+this.inSection.id),this.axios.put("/1/model/section/"+this.inSection.id+"/cardWrapper/"+a.cardWrapperId,{},{params:{onCardWrapperId:t,isBefore:this.draggingOverCardWrapperBefore,scope:a.scope}}).then(function(t){i.$store.commit("triggerUpdateSectionCards")}))}this.$store.commit("setDraggingElement",null)}}},watch:{"inSection.id":function(){this.$route.query.createCard===this.inSection.id&&this.$emit("createNew",this.cardWrappers[this.cardWrappers.length-1])}}},st=rt,ot=(i("bbeb"),Object(f["a"])(st,a,n,!1,null,"184d61ca",null));ot.options.__file="ModelCardsContainer.vue";e["a"]=ot.exports},"1d8c9":function(t,e,i){},"247e":function(t,e,i){},"26cb":function(t,e,i){},"28df":function(t,e,i){},"4d72":function(t,e,i){"use strict";var a=i("14f4"),n=i.n(a);n.a},"4f27":function(t,e,i){"use strict";var a=i("7906"),n=i.n(a);n.a},5178:function(t,e,i){},"53f4":function(t,e,i){},"542b":function(t,e,i){"use strict";var a=i("bd33"),n=i.n(a);n.a},"5bc9":function(t,e,i){"use strict";var a=i("90ab"),n=i.n(a);n.a},"5ff3":function(t,e,i){},7906:function(t,e,i){},"8ba1":function(t,e,i){"use strict";var a=i("f177"),n=i.n(a);n.a},"90ab":function(t,e,i){},"9e28":function(t,e,i){t.exports=i.p+"img/doc-icon.edaccf5c.svg"},a5c2:function(t,e,i){"use strict";var a=i("26cb"),n=i.n(a);n.a},bbeb:function(t,e,i){"use strict";var a=i("28df"),n=i.n(a);n.a},bca5:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.section?i("div",{ref:"sectionContainer",staticClass:"section-container",attrs:{id:t.section.id}},[i("div",{staticClass:"slider-container"},[i("transition",{attrs:{name:"slideDownUp"}},[t.showNewCardModal?i("app-model-card-modal",{attrs:{isNew:!0,inSectionId:t.section.id,inSectionTitle:t.section.title,addExistingInit:t.addExistingInit},on:{close:function(e){t.showNewCardModal=!1},updateCards:function(e){t.updateCards()}}}):t._e()],1)],1),t.nestedIn.length>0&&t.section.subElementsLoaded||t.showThisTitle?i("div",{staticClass:"w3-row title-row",class:{"card-container-doc":"doc"===t.cardsType}},[i("div",{staticClass:"w3-row blue-color title-text"},[t._l(t.nestedIn.slice(1,t.nestedIn.length),function(e){return i("div",{staticClass:"w3-left"},[t.addSectionLinks?i("router-link",{staticClass:"w3-left",attrs:{to:{name:"ModelSectionContent",params:{sectionId:e.id}}}},[t._v("\n           "+t._s(e.title)+"\n        ")]):i("div",{staticClass:"w3-left"},[i("span",{domProps:{innerHTML:t._s(t.headerOpenTag+e.title+t.headerCloseTag)}})]),i("div",{staticClass:"w3-left chevron-container"},[t.isDocView?i("span",{domProps:{innerHTML:t._s(t.headerOpenTag+t.faRawHtml+t.headerCloseTag)}}):i("span",{domProps:{innerHTML:t._s(t.faRawHtml)}})])],1)}),i("div",{staticClass:"w3-left"},[t.addSectionLinks?i("router-link",{attrs:{to:{name:"ModelSectionContent",params:{sectionId:t.section.id}}}},[i("b",[t._v(t._s(t.section.title))])]):i("div",{},[i("span",{domProps:{innerHTML:t._s(t.headerOpenTag+"<b>"+t.section.title+"</b>"+t.headerCloseTag)}})])],1)],2),!t.readOnly&&t.section.inSections.length>1?i("div",{staticClass:"w3-row"},[t._m(0),i("div",{staticClass:"w3-left"},[i("app-in-model-sections-tags",{attrs:{inModelSections:t.section.inSections,hideSectionId:t.inSection.id}})],1)]):t._e(),t.hasDescription?i("div",{staticClass:"w3-row description-text light-grey"},[i("vue-markdown",{staticClass:"marked-text",attrs:{source:t.section.description,anchorAttributes:{target:"_blank"}}})],1):t._e()]):t._e(),i("div",{staticClass:"w3-row"},[i("app-model-cards-container",{attrs:{cardWrappers:t.sortedCards,cardsType:t.cardsType,inSection:t.section,acceptDrop:!0,cardRouteName:t.cardRouteName,hideCardControls:t.readOnly},on:{updateCards:function(e){t.updateCards()},createNew:t.createNew,edit:t.edit,"create-card":function(e){t.createCardWithModal(e)}}})],1),i("div",{staticClass:"w3-row"},t._l(t.sortedSubsections,function(e){return i("div",{key:e.id,staticClass:"subsection-container"},[i("app-model-section",{attrs:{section:e,inSection:t.section,cardsType:t.cardsType,nestedIn:t.nestedIn.concat([t.section]),cardRouteName:t.cardRouteName,readOnly:t.readOnly,showPrivate:t.showPrivate,showShared:t.showShared,showCommon:t.showCommon},on:{updateCards:function(e){t.updateCards()}}})],1)}))]):t._e()},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"w3-left w3-margin-right"},[i("i",[t._v("also in")])])}],r=(i("20d6"),i("2054")),s=i("1a80"),o=i("d5b4"),c=i("cb70"),d={name:"app-model-section",components:{"app-model-section-header":r["a"],"app-model-cards-container":s["a"],"app-in-model-sections-tags":o["a"]},props:{section:{type:Object,default:null},showThisTitle:{type:Boolean,default:!1},nestedIn:{type:Array,default:function(){return[]}},inSection:{type:Object,default:null},cardsType:{type:String,default:"card"},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"},showPrivate:{type:Boolean,default:!0},showShared:{type:Boolean,default:!0},showCommon:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1}},data:function(){return{loaded:!1,showSubsections:!0,showCards:!0,expanded:!0,showCardId:"",expandSubSubsecInit:!1,subscription:null,showNewCardModal:!1,createNewCard:!1,editCard:!1,targetCard:{type:"new",cardWrapper:null},addExistingInit:!1,targetCards:[]}},computed:{nestedLevel:function(){return this.nestedIn.length+1},isDocView:function(){return"doc"===this.cardsType},isReadFriendly:function(){return"ModelSectionReadCard"===this.cardRouteName},addSectionLinks:function(){return!this.isReadFriendly},headerOpenTag:function(){return this.isDocView?"<h"+(this.nestedLevel<6?this.nestedLevel:6)+">":""},headerCloseTag:function(){return"doc"!==this.cardsType?"":"</h"+(this.nestedLevel<6?this.nestedLevel:6)+">"},hasDescription:function(){return!!this.section.description&&""!==this.section.description},sortedCards:function(){var t=this,e=Object(c["b"])(this.section,this.showCommon,this.showShared,this.showPrivate);if(this.createNewCard){var i=e.findIndex(function(e){return e.id===t.targetCard.cardWrapper.id});"before"===this.$store.state.support.createNewCardLocation&&(i-=1),e.splice(i+1,0,this.targetCard),this.createNewCard=!1}if(this.editCard)for(var a in this.targetCards){var n=e.findIndex(function(e){return e.id===t.targetCards[a].cardWrapper.id});this.targetCards[a].type="edit",e[n]=this.targetCards[a]}return e},sortedSubsections:function(){return Object(c["c"])(this.section,this.showCommon,this.showShared,this.showPrivate)},isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},faRawHtml:function(){return'<i class="fa fa-chevron-right" aria-hidden="true"></i>'}},watch:{"$store.state.support.triggerUpdateSectionCards":function(){this.updateCards()},section:function(){this.subscribeSocket()}},methods:{edit:function(t){if("edit"===t.type){for(var e in this.targetCards)if(JSON.stringify(t)===JSON.stringify(this.targetCards[e])){this.targetCards.splice(e,1);break}}else this.targetCard.cardWrapper=t,this.targetCard.type="edit",this.targetCards.push(JSON.parse(JSON.stringify(this.targetCard)));this.editCard=!0},createNew:function(t){this.targetCard.cardWrapper=t,this.targetCard.type="newCard",this.createNewCard=!0},createCardWithModal:function(t){this.addExistingInit=t.addExistingInit||!1,this.showNewCardModal=!0},updateCards:function(){var t=this;console.log("updating cards"),this.axios.get("/1/model/section/"+this.section.id+"/cardWrappers").then(function(e){"success"===e.data.result&&(t.createNewCard=!1,t.section.cardsWrappersCommon=e.data.data.cardsWrappersCommon,t.section.cardsWrappersPrivate=e.data.data.cardsWrappersPrivate,t.section.cardsWrappersShared=e.data.data.cardsWrappersShared)})},subscribeSocket:function(){var t=this;null===this.subscription&&(this.subscription=this.$store.dispatch("subscribe",{url:"/channel/activity/model/section/"+this.section.id,onMessage:function(e){var i=e.body;console.log("mesage on section: "+t.section.id+" - MSG: "+i),"UPDATE"===i&&t.updateCards()}}))},dragStart:function(t){var e={type:this.dragType,sectionId:this.section.id,fromElementId:this.inElementId};t.dataTransfer.setData("text/plain",JSON.stringify(e))},newCardFromBar:function(){this.showCards=!0,this.$emit("new-card")},newSubsectionFromBar:function(){this.showSubsections=!0,this.$emit("new-subsection")},handleSocket:function(){var t=this;if(this.section){console.log(this.section.id);var e="/channel/activity/model/section/"+this.section.id;this.subscription=this.$store.dispatch("subscribe",{url:e,onMessage:function(e){var i=e.body;"UPDATE"===i&&t.updateCards()}}),setInterval(function(){},1e3)}}},created:function(){this.section&&this.subscribeSocket()},beforeDestroy:function(){this.subscription&&this.$store.dispatch("unsubscribe",this.subscription)}},l=d,p=(i("4f27"),i("de96"),i("2877")),u=Object(p["a"])(l,a,n,!1,null,"18b8288e",null);u.options.__file="ModelSection.vue";e["a"]=u.exports},bd33:function(t,e,i){},c335:function(t,e,i){"use strict";var a=i("5178"),n=i.n(a);n.a},d5b4:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},t._l(t.inModelSections,function(e){return t.showThisTag(e)?i("div",{key:e.id,staticClass:"w3-left insection-tag-container"},[i("app-model-section-tag",{attrs:{section:e}})],1):t._e()}))},n=[],r=i("ef96"),s={components:{"app-model-section-tag":r["a"]},props:{inModelSections:{type:Array,default:function(){return[]}},hideSectionId:{type:String,default:""}},methods:{showThisTag:function(t){return t.id!==this.hideSectionId}}},o=s,c=(i("da50"),i("2877")),d=Object(c["a"])(o,a,n,!1,null,"593d52b5",null);d.options.__file="InModelSectionsTags.vue";e["a"]=d.exports},da50:function(t,e,i){"use strict";var a=i("53f4"),n=i.n(a);n.a},de07:function(t,e,i){"use strict";var a=i("247e"),n=i.n(a);n.a},de5a:function(t,e,i){},de96:function(t,e,i){"use strict";var a=i("de5a"),n=i.n(a);n.a},f130:function(t,e,i){},f158:function(t,e,i){},f177:function(t,e,i){},f868:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"notifications-container"},[a("popper",{attrs:{"append-to-body":!0,trigger:"click",options:t.popperOptions,toggleShow:t.toggleShow}},[a("div",{staticClass:"notifications-list-container w3-white w3-card-4 w3-bar-block noselect w3-topbar border-blue-app"},[a("div",{staticClass:"close-div w3-xlarge cursor-pointer gray-1-color",on:{click:function(e){t.closeThis()}}},[a("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),a("div",{staticClass:"w3-row w3-border-bottom notifications-header"},[a("div",{staticClass:"w3-row"},[t._v('\n         Your notifications under "'+t._s(t.elementTitle)+'"\n        ')]),a("div",{staticClass:"w3-row-padding notif-control-row"},[a("div",{staticClass:"w3-col s4",on:{click:function(e){t.showAll()}}},[a("button",{staticClass:"w3-button w3-round",class:{"app-button":t.showingAll,"app-button-light":!t.showingAll}},[t._v("\n              All\n            ")])]),a("div",{staticClass:"w3-col s4",on:{click:function(e){t.showUnreadOnly()}}},[a("button",{staticClass:"w3-button w3-round",class:{"app-button":!t.showingAll,"app-button-light":t.showingAll}},[t._v("\n              "+t._s(t.totalUnread)+" unread\n            ")])]),a("div",{staticClass:"w3-col s4",on:{click:function(e){t.allNotificationsRead()}}},[a("button",{staticClass:"w3-button w3-round app-button-green"},[t._v("\n              mark as "),a("br"),t._v("read\n            ")])])])]),t.loading?a("div",{staticClass:"w3-row w3-center loader-gif-container"},[a("img",{staticClass:"loader-gif",attrs:{src:i("cf1c"),alt:""}})]):a("div",{},[t.activities.length>0?a("app-activity-table",{attrs:{activities:t.activities,addInAppState:!0,fullWidthCard:!0,showCardsPreview:"MODEL_SECTION"===t.contextType||"INITIATIVE"===t.contextType}}):a("div",{staticClass:"w3-padding w3-center"},[a("i",[t._v(t._s(t.$t("general.NO_RESULTS_FOUND")))])])],1),a("div",{staticClass:"w3-row w3-center"},[t.allShown?t._e():a("button",{staticClass:"w3-margin-top w3-margin-bottom w3-button app-button-light",attrs:{type:"button",name:"button"},on:{click:function(e){t.showMore()}}},[t._v("\n          show more...\n        ")])])]),a("div",{staticClass:"icon-button cursor-pointer w3-display-container",attrs:{slot:"reference"},on:{click:function(e){t.showNotificationsClicked()}},slot:"reference"},[0===t.totalUnread?a("span",[a("i",{staticClass:"fa fa-circle-o circle-empty"})]):a("span",[t.onlyNotificationsUnder?a("i",{staticClass:"fa fa-circle-o circle-o"}):a("i",{staticClass:"fa fa-circle circle"})])])])],1)},n=[],r=(i("ac6a"),i("7f7f"),i("c97e")),s={components:{"app-activity-table":r["a"]},props:{element:{type:Object,default:null},contextType:{type:String,default:"MODEL_SECTION"},isSelected:{type:Boolean,default:!1}},data:function(){return{showTable:!1,loading:!1,notifications:[],totalUnread:0,currentPage:0,showingAll:!0,showingMoreNotifications:!1,allShown:!1,toggleShow:!1,subscription:null}},computed:{elementTitle:function(){switch(this.contextType){case"MODEL_CARD":return"this card";case"MODEL_SECTION":return this.element.title;case"INITIATIVE":return this.element.meta.name}return"this element"},contextElementId:function(){return this.element.id},activities:function(){var t=[];return this.notifications.forEach(function(e){var i=e.activity;i.inAppState=e.inAppState,t.push(i)}),t},url:function(){return"/1/notifications/"+this.contextType+"/"+this.contextElementId},triggerUpdateNotifications:function(){return this.$store.state.support.triggerUpdateNotifications},notificationsHere:function(){var t=[];switch(this.contextType){case"MODEL_CARD":for(var e in this.notifications)this.notifications[e].activity.modelCardWrapper&&this.notifications[e].activity.modelCardWrapper.id===this.contextElementId&&t.push(this.notifications[e]);break;case"MODEL_SECTION":for(var i in this.notifications)this.notifications[i].activity.modelSection&&this.notifications[i].activity.modelSection.id===this.contextElementId&&t.push(this.notifications[i]);break;case"INITIATIVE":for(var a in this.notifications)this.notifications[a].activity.initiative&&this.notifications[a].activity.initiative.id===this.contextElementId&&t.push(this.notifications[a])}return t},notificationsHereMessages:function(){return this.notificationsHere.filter(function(t){return"MESSAGE_POSTED"===t.activity.type})},onlyNotificationsUnder:function(){return this.notifications.length>0&&0===this.notificationsHere.length},popperOptions:function(){return{placement:"right",modifiers:{preventOverflow:{enabled:!0,boundariesElement:"viewport"}}}}},watch:{triggerUpdateNotifications:function(){this.notifications.length>0&&(console.log("updating notifications in "+this.url+" due to triggerUpdateNotifications watch"),this.updateNotifications())},"$store.state.socket.connected":function(){this.handleSocket()}},methods:{showAll:function(){this.showingAll=!0,this.updateNotifications()},showUnreadOnly:function(){this.showingAll=!1,this.updateNotifications()},updateNotifications:function(t){var e=this;t=t||!1,this.loading=!0,this.showingMoreNotifications||this.axios.get(this.url,{params:{page:0,size:10,onlyUnread:!this.showingAll}}).then(function(i){e.loading=!1,e.notifications=i.data.data.notifications,e.totalUnread=i.data.data.totalUnread,e.allShown=e.notifications.length<10,t&&e.isSelected&&"ModelSectionMessages"===e.$route.name&&e.messageNotificationsRead(),console.log("pushing notifications "+e.notifications.length+" from "+e.url),e.$store.dispatch("addPushNotifications",e.notifications)}).catch(function(t){console.log(t)})},addNotifications:function(){var t=this;this.showingMoreNotifications=!0,this.axios.get(this.url,{params:{page:this.currentPage,size:10,onlyUnread:!1}}).then(function(e){e.data.data.length<10&&(t.allShown=!0),t.notifications=t.notifications.concat(e.data.data.notifications),t.totalUnread=e.data.data.totalUnread}).catch(function(t){console.log(t)})},allNotificationsRead:function(){var t=this;this.axios.put(this.url+"/read",{}).then(function(e){t.toggleShow=!t.toggleShow,t.$store.commit("triggerUpdateNotifications"),console.log("updating notifications in "+t.url+" due to allNotificationsRead response"),t.updateNotifications(),t.hide()}).catch(function(t){console.log(t)})},messageNotificationsRead:function(){var t=this,e=this.notificationsHereMessages.map(function(t){return t.id});e.length>0&&this.axios.put("/1/notifications/read",e).then(function(e){t.$store.commit("triggerUpdateNotifications"),console.log("updating notifications in "+t.url+" due to messageNotificationsRead response"),t.updateNotifications(!1)}).catch(function(t){console.log(t)})},showMore:function(){this.currentPage+=1,this.addNotifications()},clickOutsideNotifications:function(){this.preventClickOutside||this.showTable&&this.hide()},showNotificationsClicked:function(){var t=this;this.showTable?this.hide():(this.show(),this.preventClickOutside=!0,setTimeout(function(){t.preventClickOutside=!1},500))},hide:function(){this.showTable=!1,this.showingMoreNotifications=!1},show:function(){this.showTable=!0},closeThis:function(){this.toggleShow=!this.toggleShow},handleSocket:function(){var t=this,e="";switch(this.contextType){case"MODEL_CARD":e="/channel/activity/model/card/"+this.contextElementId;break;case"MODEL_SECTION":e="/channel/activity/model/section/"+this.contextElementId;break;case"INITIATIVE":e="/channel/activity/model/initiative/"+this.contextElementId;break}this.subscription=this.$store.dispatch("subscribe",{url:e,onMessage:function(e){var i=e.body;"UPDATE"===i&&(console.log("updating notifications in "+t.url+" due to socket message"),t.updateNotifications(!0))}})}},created:function(){console.log("updating notifications in "+this.url+" due to component creation"),this.updateNotifications(!0),this.handleSocket()},beforeDestroy:function(){this.$store.dispatch("unsubscribe",this.subscription)}},o=s,c=(i("de07"),i("2877")),d=Object(c["a"])(o,a,n,!1,null,"510c259c",null);d.options.__file="NotificationsList.vue";e["a"]=d.exports},ff0c:function(t,e,i){"use strict";var a=i("1d8c9"),n=i.n(a);n.a}}]);
//# sourceMappingURL=chunk-59061785.076be97b.js.map