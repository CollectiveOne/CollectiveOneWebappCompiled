(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9f73a80"],{"0013":function(t,e,a){"use strict";var i=a("5ff3"),r=a.n(i);r.a},"14f4":function(t,e,a){},"16cf5":function(t,e,a){"use strict";var i=a("f130"),r=a.n(i);r.a},"1a80":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cards-container-list"},[t._l(t.cardWrappers,function(e){return a("div",{key:e.id,staticClass:"section-card",class:t.cardsContainerClasses,on:{dragover:function(a){a.preventDefault(),t.draggingOver(a,e)},drop:function(a){a.preventDefault(),t.cardDroped(e.id,a)}}},[t.isDraggingOver(e)&&t.draggingOverCardWrapperBefore?a("div",{staticClass:"drop-div"}):t._e(),a("div",{staticClass:"card-container-in-list"},[a("app-model-card",{attrs:{cardWrapperInit:e,inSection:t.inSection,type:t.cardsType,cardRouteName:t.cardRouteName,hideCardControls:t.hideCardControls},on:{edit:function(a){t.$emit("edit",e)},createNew:function(a){t.$emit("createNew",e)},updateCards:function(e){t.$emit("updateCards")}}})],1),t.isDraggingOver(e)&&t.draggingOverCardWrapperAfter?a("div",{staticClass:"drop-div"}):t._e()])}),!t.hideCardControls&&t.isLoggedAnEditor?a("div",{class:t.cardsContainerClasses,on:{dragover:function(e){e.preventDefault(),t.draggingOver()},drop:function(e){e.preventDefault(),t.cardDroped("",e)}}},[t.draggingOverCreateCard?a("div",{staticClass:"drop-div"}):t._e(),t.creatingNewCard?a("div",{staticClass:"card-container-in-list"},[a("app-model-card-editor",{attrs:{isNew:!0,inSection:t.inSection,type:t.cardsType},on:{edit:function(e){t.creatingNewCard=!1},updateCards:function(e){t.cardCreated()}}})],1):a("div",{},[a("popper",{attrs:{"append-to-body":!0,trigger:"click",options:t.popperOptions}},[a("app-drop-down-menu",{staticClass:"drop-menu",attrs:{items:t.newCardItems},on:{createNew:function(e){t.creatingNewCard=!0},addExisting:function(e){t.addExisting()}}}),a("button",{staticClass:"w3-button app-button-light new-card-button",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])],1)],1)]):t._e()],2)},r=[],n=(a("cadf"),a("551c"),a("097d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.cardWrapper?a("div",{staticClass:"card-base-div"},[a("div",{staticClass:"card-content-container",attrs:{draggable:t.$store.state.support.enableCardDraggingState&&t.isDraggable},on:{dragstart:function(e){t.dragStart(e)}}},[a(t.cardComponent,{tag:"component",attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,forceUpdate:t.forceUpdate,inCardSelector:t.inCardSelector,isNew:"newCard"===t.cardWrapper.type,cardRouteName:t.cardRouteName,hideCardControls:t.hideCardControls,type:t.type},on:{update:function(e){t.update()},edit:function(e){t.$emit("edit")},setConsent:function(e){t.setConsent(e)},createNew:function(e){t.$emit("createNew")},updateCards:function(e){t.$emit("updateCards")}}}),a("transition",{attrs:{name:"fadeenter"}},[t.$store.state.support.enableCardDraggingState?a("div",{staticClass:"cover-when-draggable"},[a("div",{staticClass:"cover-when-draggable-content"},[a("button",{staticClass:"w3-button app-button"},[a("i",{staticClass:"fa fa-arrows",attrs:{"aria-hidden":"true"}}),t._v(" move\n          ")]),a("button",{staticClass:"w3-button app-button-light w3-margin-left",on:{click:function(e){t.cancelDrag()}}},[a("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}}),t._v(" cancel\n          ")])])]):t._e()])],1)]):t._e()}),s=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"model-card-editor-container",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[i("div",{staticClass:"input-form",class:t.inputClass},[i("div",{staticClass:"image-row"},[t.hasImage||t.uploadingImage?i("div",{staticClass:"w3-row image-container w3-center w3-display-container"},[t.uploadingImage?i("div",{staticClass:"loader-gif-container"},[i("img",{staticClass:"loader-gif",attrs:{src:a("cf1c"),alt:""}})]):t._e(),t.uploadingImage?t._e():i("div",{},[t.hasImage?i("img",{attrs:{src:t.editedCard.imageFile.url+"?lastUpdated="+t.editedCard.imageFile.lastUpdated,alt:""},on:{click:function(e){t.showImageClick()}}}):t._e()]),t.uploadingImage?t._e():i("div",{staticClass:"w3-display-middle"},[i("input",{staticClass:"inputfile",attrs:{type:"file",name:"imageFile",id:"imageFile",accept:"image/*"},on:{change:function(e){t.newFileSelected(e)}}}),i("label",{staticClass:"w3-button app-button w3-rounded",attrs:{for:"imageFile"}},[t._v("\n            "+t._s(t.editedCard.imageFile?t.$t("general.CHANGE"):t.$t("general.UPLOAD_IMAGE"))+"\n          ")]),t.hasImage?i("button",{staticClass:"w3-button app-button-danger",on:{click:function(e){t.removeImage()}}},[t._v("\n            "+t._s(t.$t("general.REMOVE"))+"\n          ")]):t._e()])]):t._e(),i("app-error-panel",{attrs:{show:t.errorUploadingFile,message:t.errorUploadingFileMsg}})],1),i("div",{staticClass:"cursor-pointer editor-row"},[i("div",{staticClass:"w3-row input-border"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editedCard.title,expression:"editedCard.title"}],staticClass:"w3-input w3-hover-light-grey",attrs:{type:"text",placeholder:t.$t("model.TITLE")},domProps:{value:t.editedCard.title},on:{input:function(e){e.target.composing||t.$set(t.editedCard,"title",e.target.value)}}})]),i("div",{ref:"cardText",staticClass:"w3-row card-text"},[i("app-markdown-editor",{attrs:{placeholder:t.$t("model.CONTENT"),keepBackup:!1,showBorder:!1,limitMaxHeight:!1},model:{value:t.editedCard.text,callback:function(e){t.$set(t.editedCard,"text",e)},expression:"editedCard.text"}})],1)])]),i("div",{staticClass:"meta-row",class:t.controlsClass},[i("div",{staticClass:"controls-row"},[i("div",{staticClass:"w3-left scope-controls"},[i("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="COMMON"}}},[i("i",{staticClass:"fa fa-circle select-common highlight",attrs:{"aria-hidden":"true"}})]),i("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="SHARED"}}},[i("i",{staticClass:"fa fa-circle select-shared highlight",attrs:{"aria-hidden":"true"}})]),i("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.scope="PRIVATE"}}},[i("i",{staticClass:"fa fa-circle select-private highlight",attrs:{"aria-hidden":"true"}})])]),i("div",{staticClass:"w3-left scope-text-div"},[t._v("\n         "+t._s(t.cardScopeText)+"\n      ")]),i("div",{staticClass:"w3-right control-buttons"},[t.hasImage?t._e():i("div",{staticClass:"w3-right cursor-pointer indicator-comp"},[i("input",{staticClass:"inputfile",attrs:{type:"file",name:"imageFile",id:"imageFile",accept:"image/*"},on:{change:function(e){t.newFileSelected(e)}}}),t._m(0)]),t.isNew?t._e():i("div",{staticClass:"w3-right cursor-pointer w3-margin-right",on:{click:function(e){t.expandCard()}}},[i("i",{staticClass:"fa fa-expand highlight",attrs:{"aria-hidden":"true"}})])])]),i("div",{staticClass:"button-row send-button-container"},[i("div",{staticClass:"w3-row"},[i("div",{staticClass:"w3-col m6"},[i("button",{staticClass:"w3-button app-button-light",attrs:{name:"button"},on:{click:function(e){t.$emit("edit",null)}}},[t._v("\n            "+t._s(t.$t("general.CANCEL"))+"\n          ")])]),i("div",{staticClass:"w3-col m6"},[i("button",{directives:[{name:"show",rawName:"v-show",value:!t.sendingData,expression:"!sendingData"}],staticClass:"w3-button app-button",attrs:{name:"button"},on:{click:function(e){t.createCard()}}},[t._v("\n            "+t._s(t.cardButtonText)+"\n          ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.sendingData,expression:"sendingData"}],staticClass:"sending-accept light-grey w3-center"},[i("img",{attrs:{src:a("cf1c"),alt:""}})])])]),i("div",{staticClass:"w3-row"},[i("app-error-panel",{attrs:{show:t.textErrorShow,message:t.textErrorMsg}}),i("app-error-panel",{attrs:{show:t.errorCreatingCard,message:t.errorCreatingCardMessage}})],1)])])])},d=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{staticClass:"cursor-pointer",attrs:{for:"imageFile"}},[a("i",{staticClass:"fa fa-picture-o highlight",attrs:{"aria-hidden":"true"}})])}],c=a("b968"),l={components:{"app-model-card-link":c["a"]},props:{cardWrapper:{type:Object,default:null},forceUpdate:{type:Boolean,default:!0},inSection:{type:Object,default:null},hideCardControls:{type:Boolean,default:!1},inCardSelector:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},computed:{originCardWrapperAdditions:function(){return this.cardWrapper?this.cardWrapper.originCardWrapperAdditions:[]},hasOrigin:function(){return this.originCardWrapperAdditions.length>0},cardWrapperId:function(){return this.cardWrapper?this.cardWrapper.id:""},isPrivate:function(){return"PRIVATE"===this.cardWrapper.scope},isShared:function(){return"SHARED"===this.cardWrapper.scope},inSectionId:function(){return this.inSection?this.inSection.id:""},isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},alsoInSections:function(){var t=this;return this.cardWrapper.inModelSections.filter(function(e){return t.inSection.id!==e.id})},containerClass:function(){var t={};switch(this.cardWrapper.scope){case"PRIVATE":t["border-red"]=!0;break;case"SHARED":t["border-yellow"]=!0;break;case"COMMON":t["border-blue"]=!0;break;default:t["border-gray"]=!0;break}return t},showLikes:function(){return!this.isPrivate&&!this.governanceTypeIsConsent},showConsentPositions:function(){return!this.isPrivate&&this.governanceTypeIsConsent},governanceTypeIsConsent:function(){return"SIMPLE_CONSENT"===this.cardWrapper.governanceType},consentIsOpened:function(){return"OPENED"===this.cardWrapper.simpleConsentState}},methods:{cardClicked:function(){this.inCardSelector||this.$router.push({name:this.cardRouteName,params:{cardId:this.cardWrapperId}})},editors:function(){var t=[];for(var e in this.cardWrapper.editors)this.cardWrapper.editors[e].c1Id!==this.cardWrapper.creator.c1Id&&t.push(this.cardWrapper.editors[e]);return t}}},p={name:"model-card-as-card",mixins:[l],components:{},props:{isNew:{type:Boolean,default:!1},inSection:{type:Object,default:null},cardWrapper:{type:Object,default:null},type:{type:String,default:"card"}},data:function(){return{editing:!0,editedCard:{title:"",text:"",newScope:"COMMON"},hovering:!1,showFull:!1,addExisting:!1,sendingData:!1,loading:!1,scope:"COMMON",uploadingImage:!1,errorUploadingFile:!1,errorUploadingFileMsg:"",errorCreatingCard:!1,errorCreatingCardMessage:"",cardEmptyError:!1}},computed:{errorTitleTooLongShow:function(){return this.titleTooLong},titleEmpty:function(){return!!this.editedCard&&""===this.editedCard.title},titleTooLong:function(){return!!this.editedCard&&this.editedCard.title.length>42},textEmpty:function(){return!!this.editedCard&&""===this.editedCard.text},cardEmpty:function(){return this.textEmpty&&this.titleEmpty},textErrorShow:function(){return this.cardEmptyShow||this.titleTooLong},cardEmptyShow:function(){return this.cardEmptyError&&this.cardEmpty},textErrorMsg:function(){return this.titleTooLong?this.$t("model.TITLE_TOO_LONG"):this.$t("model.CARD_EMPTY")},noCardSelected:function(){return null===this.existingCard},noCardSelectedShow:function(){return this.noCardSelectedError&&this.noCardSelected},atCardWrapper:function(){return null===this.cardWrapper?null:this.cardWrapper.cardWrapper},cardWrapperIdForImage:function(){return this.isNew?"":this.atCardWrapper.id},newCardLocation:function(){return"before"===this.$store.state.support.createNewCardLocation},cardButtonText:function(){return this.isNew?this.$t("general.CREATE"):this.$t("general.SAVE")},hasImage:function(){return null!=this.editedCard.imageFile},containerClass:function(){var t={};return t["border-red"]="PRIVATE"===this.scope,t["border-yellow"]="SHARED"===this.scope,t["border-blue"]="COMMON"===this.scope,t["w3-card-4 w3-topbar w3-round-large"]="card"===this.type,t["card-summary-container w3-leftbar w3-card w3-row"]="summary"===this.type,t["card-editor-doc"]="doc"===this.type,t},inputClass:function(){var t={};return t["w3-row card-container cursor-pointer limit-height"]="card"===this.type,t["w3-col m8 left-div"]="summary"===this.type,t["w3-row w3-col s12"]="doc"===this.type,t},controlsClass:function(){var t={};return t["w3-row bottom-row light-grey"]="card"===this.type,t["w3-col m4 controls-summary"]="summary"===this.type,t},card:function(){return this.atCardWrapper.card},cardScopeText:function(){switch(this.scope){case"PRIVATE":return this.$t("model.PRIVATE");case"SHARED":return this.$t("model.SHARED");case"COMMON":return this.$t("model.COMMON")}return""}},methods:{expandCard:function(){this.inCardSelector||this.$router.push({name:this.cardRouteName,params:{cardId:this.cardWrapperIdForImage}})},removeImage:function(){this.editedCard.imageFile=null,this.editedCard.newImageFileId="REMOVE"},newFileSelected:function(t){var e=this,a=t.target.files[0];if(a.size>1048576)return this.errorUploadingFile=!0,void(this.errorUploadingFileMsg="Image file too big. Must be below 1 MB");var i=new FormData;i.append("file",a),this.uploadingImage=!0,this.errorUploadingFile=!1,this.axios.post("/1/upload/cardImage/"+this.cardWrapperIdForImage,i).then(function(t){if(console.log(t),e.uploadingImage=!1,"success"===t.data.result)return e.editedCard.newImageFileId=t.data.elementId,e.axios.get("/1/files/"+e.editedCard.newImageFileId);e.errorUploadingFile=!0,e.errorUploadingFileMsg=t.data.message}).then(function(t){var a=JSON.parse(JSON.stringify(e.editedCard));a.imageFile=t.data.data,e.editedCard=a})},showImageClick:function(){this.editing||(this.showImage=!0)},startEditing:function(){this.editedCard=JSON.parse(JSON.stringify(this.atCardWrapper.card)),this.scope=this.atCardWrapper.scope},textTooLong:function(){return!!this.$refs.cardText&&(this.$refs.cardText.scrollHeight>250||this.$refs.cardText.clientHeight<this.$refs.cardText.scrollHeight)},hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1},createCard:function(){var t=this,e=!0;if(this.addExisting?this.noCardSelected&&(e=!1,this.noCardSelectedError=!0):(this.titleTooLong&&(e=!1),this.cardEmpty&&(this.cardEmptyError=!0,e=!1)),e){this.editedCard.newScope=this.scope;var a=JSON.parse(JSON.stringify(this.editedCard));this.isNew?this.addExisting||(this.sendingData=!0,this.axios.post("/1/model/section/"+this.inSection.id+"/cardWrapper",a,{params:{onCardWrapperId:this.atCardWrapper?this.atCardWrapper.id:null,isBefore:this.newCardLocation}}).then(function(e){t.sendingData=!1,"success"===e.data.result?t.$emit("updateCards"):(t.errorCreatingCard=!0,t.errorCreatingCardMessage=e.data.message)}).catch(function(t){console.log(t)})):(console.log("editing",this.inSection.id,this.type,this.atCardWrapper.id,this.scope,a),this.sendingData=!0,this.axios.put("/1/model/cardWrapper/"+this.atCardWrapper.id,a,{params:{inSectionId:this.inSection.id}}).then(function(e){console.log(e),t.sendingData=!1,"success"===e.data.result&&(t.$emit("updateCards"),t.$emit("edit",null))}).catch(function(t){console.log(t)}))}},atKeydown:function(t){this.editing&&(27===t.keyCode&&this.$emit("edit"),13===t.keyCode&&t.ctrlKey&&(t.preventDefault(),this.createCard()))}},mounted:function(){this.isNew?(this.editedCard={title:"",text:"",newScope:"SHARED"},this.editing=!0):this.startEditing(),window.addEventListener("keydown",this.atKeydown)},destroyed:function(){window.removeEventListener("keydown",this.atKeydown)}},u=p,h=(a("a8de"),a("2877")),g=Object(h["a"])(u,o,d,!1,null,"ccee8686",null);g.options.__file="ModelCardEditor.vue";var f=g.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-summary-container w3-leftbar w3-card w3-row",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[a("div",{staticClass:"w3-col m8 left-div"},[t.inCardSelector?t._e():a("div",{staticClass:"w3-left expand-btn cursor-pointer",on:{click:function(e){t.cardClicked()}}},[a("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}})]),a("div",{staticClass:"w3-left text-div"},[t._v("\n      "+t._s(t.cardShortTitle)+"\n    ")]),t.cardWrapper.inModelSections.length>0&&!t.hideCardControls?a("div",{staticClass:"w3-right text-div"},[a("app-in-model-sections-tags",{attrs:{inModelSections:t.cardWrapper.inModelSections,hideSectionId:t.inSectionId}})],1):t._e()]),a("div",{staticClass:"w3-col m4 right-div"},[t.inCardSelector?t._e():a("div",{},[a("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName,hideInSectionTags:!0},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1)])])},m=[],v=a("d5b4"),w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-indicators-container"},[t.hasOrigin?a("div",{staticClass:"origin-row w3-row"},[a("i",[t._v(t._s(t.$t("model.ORIGIN"))+":")]),a("app-model-card-link",{attrs:{cardWrapper:t.originCardWrapperAdditions[0].cardWrapper,onSection:t.originCardWrapperAdditions[0].section}}),t._v(" "+t._s(t.$t("general.IN"))+"\n    "),t._l(t.originCardWrapperAdditions,function(t){return a("app-model-section-tag",{key:t.id,staticClass:"on-origin-section",attrs:{section:t.section}})})],2):t._e(),a("div",{staticClass:"common-row w3-row",class:{"common-row-with-gov":t.showConsentPositions}},[a("div",{staticClass:"w3-left"},[null!==t.cardWrapper.creator?a("div",{staticClass:"w3-left text-div"},[a("app-user-avatar",{attrs:{user:t.cardWrapper.creator,showName:!1,small:!0}})],1):t._e(),t.editors.length>0?a("div",{staticClass:"w3-left editors-div"},t._l(t.editors,function(e){return a("div",{staticClass:"w3-left"},[e.c1Id!==t.cardWrapper.creator.c1Id?a("app-user-avatar",{attrs:{user:e,showName:!1,small:!0}}):t._e()],1)})):t._e(),t.alsoInSections.length>0&&!t.hideCardControls&&!t.hideInSectionTags?a("div",{staticClass:"w3-margin-left w3-left"},[a("app-in-model-sections-tags",{attrs:{inModelSections:t.alsoInSections}})],1):t._e()]),a("div",{staticClass:"w3-right"},[a("div",{staticClass:"w3-right"},[a("app-notifications-list",{attrs:{element:t.cardWrapper,contextType:"MODEL_CARD"}})],1),!t.hideCardControls&&this.isLoggedAnEditor?a("div",{staticClass:"w3-right gray-1-color control-div"},[a("app-card-control-buttons",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,showDetach:t.alsoInSections.length>0},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},startConsent:function(e){t.$emit("setConsent",!0)},stopConsent:function(e){t.$emit("setConsent",!1)},updateCards:function(e){t.$emit("updateCards")}}})],1):t._e(),t.isPrivate?t._e():a("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.cardClicked()}}},[a("app-indicator",{attrs:{contextType:"MODEL_CARD",contextElementId:t.cardWrapper.id,size:18,type:"messages",forceUpdate:t.forceUpdate}})],1),t.showLikes?a("div",{staticClass:"w3-right cursor-pointer indicator-comp",on:{click:function(e){t.toggleLike()}}},[a("app-indicator",{attrs:{contextType:"MODEL_CARD",contextElementId:t.cardWrapper.id,size:18,type:"likes",selected:t.cardWrapper.userLiked,autoUpdate:!1,countInit:t.cardWrapper.nLikes}})],1):t._e()])]),t.showConsentPositions?a("div",{staticClass:"governance-row w3-row"},[a("app-consent-positions",{attrs:{elementId:t.cardWrapper.additionId,ownPosition:t.cardWrapper.ownPosition,disabled:!t.consentIsOpened},on:{update:function(e){t.$emit("update")}}})],1):t._e()])},S=[],b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"modals"},[a("div",{staticClass:"slider-container"},[a("transition",{attrs:{name:"slideDownUp"}},[t.showMoveCardModal?a("app-move-card-modal",{attrs:{isMove:t.isMove,cardWrapperToMove:t.cardWrapper,fromSection:t.inSection},on:{close:function(e){t.showMoveCardModal=!1},update:function(e){t.$emit("updateCards")}}}):t._e()],1)],1)]),a("popper",{attrs:{"append-to-body":!0,trigger:"click",options:t.popperOptions,toggleShow:t.togglePopperShow}},[a("div",{staticClass:"drop-menu-div"},[a("app-drop-down-menu",{staticClass:"drop-menu",attrs:{items:t.menuItems},on:{edit:function(e){t.edit()},detach:function(e){t.detachIntent=!0},startConsent:function(e){t.startConsent()},stopConsent:function(e){t.stopConsent()},addCardBefore:function(e){t.addCardLocation("before")},addCardAfter:function(e){t.addCardLocation("after")},addToSection:function(e){t.addToSection()},moveToSection:function(e){t.moveToSection()},remove:function(e){t.remove()},enableDrag:function(e){t.enableDrag()}}}),a("div",{staticClass:"w3-card w3-white drop-menu"},[t.detachIntent?a("div",{staticClass:"w3-row w3-center delete-intent-div"},[a("div",{staticClass:"w3-padding w3-round light-grey w3-margin-bottom"},[a("p",{domProps:{innerHTML:t._s(t.$t("model.DETACH_CARD_WARNING"))}})]),a("button",{staticClass:"w3-button light-grey",on:{click:function(e){t.detachIntent=!1}}},[t._v(t._s(t.$t("general.CANCEL"))+"\n          ")]),a("button",{staticClass:"w3-button button-blue",on:{click:function(e){t.detachConfirmed()}}},[t._v(t._s(t.$t("general.CONFIRM"))+"\n          ")])]):t._e(),t.removeIntent?a("div",{staticClass:"w3-row w3-center delete-intent-div"},[a("div",{staticClass:"w3-padding w3-round light-grey w3-margin-bottom"},[a("p",{domProps:{innerHTML:t._s(t.$t("model.REMOVE_CARD_WARNING",{title:t.inSection.title}))}})]),a("button",{staticClass:"w3-button light-grey",on:{click:function(e){t.removeIntent=!1}}},[t._v(t._s(t.$t("general.CANCEL"))+"\n          ")]),a("button",{staticClass:"w3-button button-blue",on:{click:function(e){t.removeConfirmed()}}},[t._v(t._s(t.$t("general.CONFIRM"))+"\n          ")])]):t._e()])],1),a("div",{staticClass:"expand-btn cursor-pointer",attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"fa fa-bars",attrs:{"aria-hidden":"true"}})])])],1)},_=[],I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"w3-modal",attrs:{draggable:"false"}},[i("div",{staticClass:"w3-modal-content"},[i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.clickOutside,expression:"clickOutside"}],staticClass:"w3-card-4 app-modal-card w3-display-container"},[i("div",{staticClass:"w3-display-topright"},[i("div",{staticClass:"w3-right w3-button close-btn w3-xlarge",on:{click:function(e){t.closeThisConfirm()}}},[i("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])]),i("div",{staticClass:"w3-container w3-border-bottom"},[i("h3",[t._v(t._s(t.$t("model.MOVE_CARD")))])]),i("div",{staticClass:"div-modal-content w3-container"},[i("div",{staticClass:"w3-row"},[i("div",{staticClass:"w3-card-4 w3-topbar w3-round-large w3-margin-bottom"},[i("app-model-card-as-card-content",{attrs:{card:t.cardWrapperToMove.card,showFull:!1}})],1)]),i("div",{staticClass:"section-tabs w3-row w3-center light-grey"},[i("div",{staticClass:"w3-col s6 w3-bottombar w3-hover-light-grey cursor-pointer",class:{"border-blue-app":!t.isMoveInternal},on:{click:function(e){t.isMoveInternal=!1}}},[i("h5",{staticClass:"noselect",class:{"bold-text":!t.isMoveInternal}},[t._v(t._s(t.$t("model.ADD_ALSO_TO")))])]),i("div",{staticClass:"w3-col s6 w3-bottombar w3-hover-light-grey cursor-pointer",class:{"border-blue-app":t.isMoveInternal},on:{click:function(e){t.isMoveInternal=!0}}},[i("h5",{staticClass:"noselect",class:{"bold-text":!t.isMoveInternal}},[t._v(t._s(t.$t("model.MOVE_TO")))])])]),i("div",{staticClass:"w3-row"},[i("app-model-section-selector",{attrs:{sectionId:t.$store.state.initiative.initiative.topModelSection.id},on:{select:function(e){t.sectionSelected(e)}}}),i("app-error-panel",{attrs:{show:t.noSectionSelectedShow,message:"please select one section from above"}})],1),i("div",{staticClass:"w3-row w3-container w3-margin-top"},[i("label",{},[i("b",[t._v('New scope (in "'+t._s(t.inSectionTitle)+'" section):')])]),i("select",{directives:[{name:"model",rawName:"v-model",value:t.newScope,expression:"newScope"}],staticClass:"w3-input w3-topbar",class:t.scopeBorderClass,attrs:{name:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.newScope=e.target.multiple?a:a[0]}}},[i("option",{attrs:{value:"PRIVATE"}},[t._v("Private (only I can see it)")]),i("option",{attrs:{value:"SHARED"}},[t._v("Shared (others can see it, but its mine)")]),i("option",{attrs:{value:"COMMON"}},[t._v("Common (controlled by all editors)")])])]),i("div",{staticClass:"modal-bottom-btns-row w3-row-padding"},[i("hr"),i("div",{staticClass:"w3-col m6"},[i("button",{staticClass:"w3-button app-button-light",attrs:{type:"button"},on:{click:function(e){t.closeThisConfirm()}}},[t._v("\n              "+t._s(t.$t("general.CANCEL"))),t._m(0)])]),i("div",{staticClass:"w3-col m6 w3-center"},[i("button",{directives:[{name:"show",rawName:"v-show",value:!t.sendingData,expression:"!sendingData"}],staticClass:"w3-button app-button",attrs:{type:"button"},on:{click:function(e){t.accept()}}},[t._v("\n              "+t._s(t.$t("general.ACCEPT"))),t._m(1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.sendingData,expression:"sendingData"}],staticClass:"sending-accept light-grey"},[i("img",{attrs:{src:a("cf1c"),alt:""}})])])])])])])])},y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("small",[t._v("(Esc)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[a("small",[t._v("(Ctr + Enter)")])])}],E=a("f9c2"),O=a("6f47"),W={components:{"app-model-section-selector":E["a"],"app-model-card-as-card-content":O["a"]},props:{isMove:{type:Boolean,default:!1},cardWrapperToMove:{type:Object},fromSection:{type:Object}},data:function(){return{toSection:null,isMoveInternal:!1,noSectionSelectedError:!1,newScope:"COMMON",sendingData:!1}},computed:{noSectionSelectedShow:function(){return null==this.toSection&&this.noSectionSelectedError},inSectionTitle:function(){return null!=this.toSection?this.toSection.title:""},scopeBorderClass:function(){var t={};switch(this.newScope){case"PRIVATE":t["border-red"]=!0;break;case"SHARED":t["border-yellow"]=!0;break;default:t["border-blue"]=!0;break}return t}},methods:{closeThisConfirm:function(){this.$emit("close")},clickOutside:function(){this.closeThisConfirm()},sectionSelected:function(t){this.toSection=t},accept:function(){var t=this,e=!0;null==this.toSection&&(this.noSectionSelectedError=!0,e=!1),e&&(this.sendingData=!0,this.isMove?this.axios.put("/1/model/section/"+this.fromSection.id+"/moveCard/"+this.cardWrapperToMove.id,{},{params:{onSectionId:this.toSection.id,scope:this.newScope}}).then(function(e){t.$emit("update"),t.sendingData=!1,t.closeThisConfirm()}):this.axios.put("/1/model/section/"+this.toSection.id+"/cardWrapper/"+this.cardWrapperToMove.id,{},{params:{scope:this.newScope}}).then(function(e){t.$emit("update"),t.sendingData=!1,t.closeThisConfirm()}))}},created:function(){this.isMoveInternal=this.isMove}},T=W,$=(a("9559"),Object(h["a"])(T,I,y,!1,null,"3d31e84c",null));$.options.__file="MoveCardModal.vue";var N=$.exports,x={components:{"app-move-card-modal":N},props:{cardWrapper:{type:Object,default:null},inSection:{type:Object,deafult:null},showDetach:{type:Boolean,default:!1}},data:function(){return{showNewCardModal:!1,newCardLocation:"end",showEditCardModal:!1,showMoveCardModal:!1,detachIntent:!1,removeIntent:!1,togglePopperShow:!1,isMove:!1}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},isPrivate:function(){return"PRIVATE"===this.cardWrapper.scope},isShared:function(){return"SHARED"===this.cardWrapper.scope},isLoggedTheAuthor:function(){return this.cardWrapper.creator.c1Id===this.$store.state.user.profile.c1Id},isConsent:function(){return"SIMPLE_CONSENT"===this.cardWrapper.governanceType},isConsentOpened:function(){return"OPENED"===this.cardWrapper.simpleConsentState},menuItems:function(){var t=[];switch(this.cardWrapper.scope){case"PRIVATE":case"SHARED":this.isLoggedTheAuthor&&t.push({text:this.$t("general.EDIT"),value:"edit",faIcon:"fa-pencil"});break;case"COMMON":this.isLoggedAnEditor&&(t.push({text:this.$t("general.EDIT"),value:"edit",faIcon:"fa-pencil"}),this.showDetach&&t.push({text:this.$t("model.DETACH_LC"),value:"detach",faIcon:"fa-chain-broken"}));break}return this.isLoggedAnEditor&&t.push({text:this.$t("model.ADD_CARD_BEFORE"),value:"addCardBefore",faIcon:"fa-plus"}),this.isLoggedAnEditor&&t.push({text:this.$t("model.ADD_CARD_AFTER"),value:"addCardAfter",faIcon:"fa-plus"}),this.isLoggedAnEditor&&t.push({text:this.$t("model.ADD_TO_SECTION"),value:"addToSection",faIcon:"fa-clone"}),this.isLoggedAnEditor&&t.push({text:this.$t("model.MOVE_TO_SECTION"),value:"moveToSection",faIcon:"fa-arrow-right"}),this.isLoggedAnEditor&&t.push({text:this.$store.state.support.enableCardDraggingState?this.$t("model.DISABLE_DRAG_AND_DROP"):this.$t("model.ENABLE_DRAG_AND_DROP"),value:"enableDrag",faIcon:"fa-arrows"}),this.isLoggedAnEditor&&!this.isConsent?t.push({text:this.$t("model.START_CONSENT"),value:"startConsent",faIcon:"fa-users"}):this.isConsentOpened?t.push({text:this.$t("model.STOP_CONSENT"),value:"stopConsent",faIcon:"fa-users"}):t.push({text:this.$t("model.REOPEN_CONSENT"),value:"startConsent",faIcon:"fa-users"}),this.isLoggedAnEditor&&t.push({text:this.$t("general.REMOVE"),value:"remove",faIcon:"fa-times"}),t},popperOptions:function(){return{placement:"bottom-start",modifiers:{preventOverflow:{enabled:!1}}}}},methods:{startConsent:function(){this.togglePopperShow=!this.togglePopperShow,this.$emit("startConsent")},stopConsent:function(){this.togglePopperShow=!this.togglePopperShow,this.$emit("stopConsent")},addCardLocation:function(t){this.$store.commit("createNewCardLocation",t),this.$emit("createNew"),this.togglePopperShow=!this.togglePopperShow},addToSection:function(){this.isMove=!1,this.showMoveCardModal=!0},moveToSection:function(){this.isMove=!0,this.showMoveCardModal=!0},edit:function(){this.$emit("edit"),this.togglePopperShow=!this.togglePopperShow},remove:function(){this.removeIntent=!0},enableDrag:function(){this.togglePopperShow=!this.togglePopperShow,this.$store.commit("setCardDraggingState",!0)},detachConfirmed:function(){var t=this;this.axios.put("/1/model/section/"+this.inSection.id+"/detachCardWrapper/"+this.cardWrapper.id,{}).then(function(e){console.log(e),"success"===e.data.result?(t.detachIntent=!1,t.togglePopperShow=!t.togglePopperShow,t.$emit("updateCards")):t.showOutputMessage(e.data.message)}).catch(function(t){console.log(t)})},removeConfirmed:function(){var t=this;this.axios.put("/1/model/section/"+this.inSection.id+"/removeCard/"+this.cardWrapper.id,{}).then(function(e){console.log(e),"success"===e.data.result?(t.removeIntent=!1,t.togglePopperShow=!t.togglePopperShow,t.$emit("updateCards")):t.showOutputMessage(e.data.message)}).catch(function(t){console.log(t)})}},mounted:function(){},destroyed:function(){}},M=x,D=(a("fb9b"),Object(h["a"])(M,b,_,!1,null,"e02dad28",null));D.options.__file="CardControlButtons.vue";var A=D.exports,k=a("f868"),L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w3-row positions-container"},[a("popper",{staticClass:"w3-left",attrs:{trigger:"click",options:t.popperOptions,toggleShow:t.toggleShowPopper,disabled:t.disabled}},[a("div",{staticClass:"position-selector w3-card w3-white"},[a("div",{staticClass:"w3-row"},[t._v("\n        "+t._s(t.$t("model.MY_POSITION_ON_CARD"))+":\n      ")]),a("div",{staticClass:"w3-row w3-margin-top"},[a("div",{staticClass:"w3-left position-tag position-tag-green tag-margin",on:{click:function(e){t.setOwnPosition("GREEN")}}},[t._v("\n          "+t._s(t.$t("model.SUPPORT"))+"\n        ")]),a("div",{staticClass:"w3-left position-tag position-tag-yellow tag-margin",on:{click:function(e){t.setOwnPosition("YELLOW")}}},[t._v("\n          "+t._s(t.$t("model.UNDECIDED"))+"\n        ")]),a("div",{staticClass:"w3-left position-tag position-tag-red",on:{click:function(e){t.setOwnPosition("RED")}}},[t._v("\n          "+t._s(t.$t("model.OBJECT"))+"\n        ")])])]),a("div",{staticClass:"cursor-pointer avatar-position",class:t.getBorderClass(t.ownPosition),attrs:{slot:"reference"},slot:"reference"},[a("app-user-avatar",{attrs:{user:t.$store.state.user.profile,showName:!1,small:!0,enableHover:!1}})],1)]),t.othersPositions.length>0?a("div",{staticClass:"vertical-separator w3-left"}):t._e(),t._l(t.othersPositions,function(e){return a("div",{key:e.id,staticClass:"w3-left avatar-position",class:t.getBorderClass(e.positionColor)},[a("app-user-avatar",{attrs:{user:e.author,showName:!1,small:!0}})],1)}),t.disabled?a("div",{staticClass:"cover-div cover-div-closed"},[a("b",[t._v(t._s(t.$t("model.CLOSED")))])]):a("div",{staticClass:"cover-div cover-div-open"},[a("b",[t._v(t._s(t.$t("model.OPEN")))])])],2)},P=[],R={props:{elementId:{type:String},ownPosition:{type:String,default:null},disabled:{type:Boolean,default:!1}},data:function(){return{positions:[],toggleShowPopper:!1}},computed:{hasOwnPosition:function(){return null!=this.ownPosition},othersPositions:function(){var t=this;return this.positions.filter(function(e){return e.author.c1Id!==t.$store.state.user.profile.c1Id})},popperOptions:function(){return{placement:"right",modifiers:{preventOverflow:{enabled:!0,boundariesElement:"viewport"}}}}},methods:{getBorderClass:function(t){switch(t){case"GREEN":return{"avatar-border-green":!0};case"YELLOW":return{"avatar-border-yellow":!0};case"RED":return{"avatar-border-red":!0}}},updatePositions:function(){var t=this;this.axios.get("/1/model/cardAddition/"+this.elementId+"/consentPositions",{params:{elementType:"CARD_WRAPPER_ADDITION"}}).then(function(e){t.positions=e.data.data})},setOwnPosition:function(t){var e=this;this.toggleShowPopper=!this.toggleShowPopper,this.axios.put("/1/model/cardAddition/"+this.elementId+"/consentPosition",{},{params:{consentPosition:t,elementType:"CARD_WRAPPER_ADDITION"}}).then(function(t){e.$emit("update")})}},mounted:function(){this.updatePositions()}},B=R,F=(a("4d72"),Object(h["a"])(B,L,P,!1,null,"7206887d",null));F.options.__file="ConsentPositions.vue";var U=F.exports,H={mixins:[l],components:{"app-card-control-buttons":A,"app-in-model-sections-tags":v["a"],"app-notifications-list":k["a"],"app-consent-positions":U},props:{hideInSectionTags:{type:Boolean,default:!1}},data:function(){return{forceConsentUpdate:!1}},computed:{stateIsRed:function(){return!!this.cardWrapper.semaphoreState&&"RED"===this.cardWrapper.semaphoreState},stateIsYellow:function(){return!!this.cardWrapper.semaphoreState&&"YELLOW"===this.cardWrapper.semaphoreState},stateIsGreen:function(){return!!this.cardWrapper.semaphoreState&&"GREEN"===this.cardWrapper.semaphoreState}},methods:{toggleLike:function(){var t=this;this.axios.put("/1/model/card/"+this.cardWrapper.id+"/like",{},{params:{likeStatus:!this.cardWrapper.userLiked}}).then(function(e){t.$emit("update")})}}},j=H,V=(a("16cf5"),Object(h["a"])(j,w,S,!1,null,"596fd6b7",null));V.options.__file="CardUserIndicators.vue";var J=V.exports,G={name:"model-card-summary",mixins:[l],components:{"app-in-model-sections-tags":v["a"],"app-card-user-indicators":J},props:{},data:function(){return{hovering:!1}},computed:{cardShortTitle:function(){return""!==this.card.title?this.card.title:this.card.text?this.card.text.length<40?this.card.text:this.card.text.slice(0,40)+"...":""},card:function(){return this.cardWrapper.card},hasImage:function(){return null!==this.card.imageFile}},methods:{hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1}},created:function(){}},Y=G,K=(a("c335"),Object(h["a"])(Y,C,m,!1,null,"5911aee3",null));K.options.__file="ModelCardSummary.vue";var z=K.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w3-display-container w3-card-4 w3-topbar w3-round-large",class:t.containerClass,on:{mouseover:function(e){t.hovering=!0},mouseleave:function(e){t.hovering=!1}}},[a("div",{staticClass:"card-content-container",class:{"limit-height":!t.showFull}},[a("div",{ref:"cardContent"},[a("app-model-card-as-card-content",{attrs:{card:t.card,showFull:t.showFull},on:{"card-clicked":function(e){t.cardClicked()}}})],1)]),a("div",{staticClass:"w3-row bottom-row light-grey"},[t.textTooLong?a("div",{staticClass:"expand-height-button"},[a("div",{staticClass:"w3-padding gray-2-color cursor-pointer",on:{click:function(e){t.showMoreClick()}}},[a("i",{staticClass:"fa fa-arrows-v",attrs:{"aria-hidden":"true"}})])]):t._e(),t.inCardSelector?t._e():a("div",{staticClass:"w3-row"},[a("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1)]),a("transition",{attrs:{name:"fadeenter"}},[t.hovering&&!t.inCardSelector?a("div",{staticClass:"w3-padding gray-2-color w3-display-topright cursor-pointer",on:{click:function(e){t.cardClicked()}}},[a("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}})]):t._e()])],1)},X=[],Q={name:"model-card-as-card",mixins:[l],components:{"app-card-user-indicators":J,"app-model-card-as-card-content":O["a"]},props:{},data:function(){return{hovering:!1,showFull:!1,textTooLong:!1}},computed:{card:function(){return this.cardWrapper.card}},methods:{checkTextTooLong:function(){this.$refs.cardContent||(this.textTooLong=!1),console.log(this.$refs.cardContent.scrollHeight),this.$refs.cardContent.scrollHeight>250?this.textTooLong=!0:this.textTooLong=this.$refs.cardContent.clientHeight<this.$refs.cardContent.scrollHeight},hoverEnter:function(){this.showActionButton=!0,this.highlight=!0},hoverLeave:function(){this.showActionButton=!1,this.highlight=!1},showMoreClick:function(){this.showFull=!this.showFull}},mounted:function(){var t=this;this.$nextTick(function(){t.checkTextTooLong()})}},Z=Q,tt=(a("5bc9"),Object(h["a"])(Z,q,X,!1,null,"60fc2661",null));tt.options.__file="ModelCardAsCard.vue";var et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-container-doc",on:{mouseover:function(e){t.mouseOver()},mouseleave:function(e){t.mouseLeave()}}},[a("div",{staticClass:"w3-row"},[a("div",{staticClass:"w3-col s12"},[a("div",{class:t.containerClassPar,on:{click:function(e){t.clicked=!1}}},[""!==t.card.title?a("div",{staticClass:"w3-row card-title"},[t._v("\n          "+t._s(t.card.title)+"\n        ")]):t._e(),a("div",{ref:"cardText",staticClass:"w3-row card-text"},[t.card.text?a("vue-markdown",{staticClass:"marked-text",attrs:{source:t.card.text,anchorAttributes:{target:"_blank"}}}):t._e()],1)]),t.hasImage?a("div",{staticClass:"w3-row w3-center w3-display-container image-container"},[a("img",{attrs:{src:t.card.imageFile.url+"?lastUpdated="+t.card.imageFile.lastUpdated,alt:""}})]):t._e(),t.$store.state.user.authenticated?a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.clickOutside,expression:"clickOutside"}]},[a("transition",{attrs:{name:"fadeenter"}},[t.clicked?a("div",{staticClass:"user-indicators-div w3-card-2 w3-white"},[a("app-card-user-indicators",{attrs:{cardWrapper:t.cardWrapper,inSection:t.inSection,hideCardControls:t.hideCardControls,inCardSelector:t.inCardSelector,cardRouteName:t.cardRouteName},on:{update:function(e){t.$emit("update")},createNew:function(e){t.$emit("createNew")},edit:function(e){t.$emit("edit")},setConsent:function(e){t.$emit("setConsent",e)},updateCards:function(e){t.$emit("updateCards")}}})],1):a("div",{staticClass:"expand-button gray-1-color",on:{click:function(e){t.clicked=!0}}},[a("i",{staticClass:"fa fa-ellipsis-v",attrs:{"aria-hidden":"true"}})])])],1):t._e()])])])},it=[],rt={name:"model-card-as-par",mixins:[l],components:{"app-card-user-indicators":J},props:{cardWrapper:{type:Object,default:null},forceUpdate:{type:Boolean,default:!0},inSection:{type:Object,default:null}},data:function(){return{hovering:!1,clicked:!1}},computed:{card:function(){return this.cardWrapper.card},hasImage:function(){return null!==this.card.imageFile},containerClassPar:function(){var t=this.containerClass;return t["card-container-padded"]=!this.hideCardControls,t}},methods:{clickOutside:function(){this.clicked=!1},mouseOver:function(){},mouseLeave:function(){}},mounted:function(){}},nt=rt,st=(a("8ba1"),a("ff0c"),Object(h["a"])(nt,at,it,!1,null,"92035d1c",null));st.options.__file="ModelCardAsPar.vue";var ot=st.exports,dt={name:"model-card",components:{"app-model-card-editor":f,"app-model-card-summary":z,"app-model-card-as-card":et,"app-model-card-as-par":ot},props:{cardWrapperInit:{type:Object,default:null},inSection:{type:Object,default:null},type:{type:String,default:"card"},forceUpdate:{type:Boolean,default:!0},inCardSelector:{type:Boolean,default:!1},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},watch:{cardWrapperInit:function(){this.cardWrapper=this.cardWrapperInit}},data:function(){return{cardWrapper:null}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},authorIsLoggedUser:function(){return!!this.$store.state.user.profile&&this.$store.state.user.profile.c1Id===this.cardWrapper.creator.c1Id},isDraggable:function(){return"COMMON"===this.cardWrapper.scope?this.isLoggedAnEditor:this.authorIsLoggedUser},cardComponent:function(){if("newCard"===this.cardWrapper.type||"edit"===this.cardWrapper.type||"new"===this.type)return"app-model-card-editor";switch(this.type){case"summary":return"app-model-card-summary";case"card":return"app-model-card-as-card";case"doc":return"app-model-card-as-par";default:return"app-model-card-as-card"}}},methods:{update:function(){var t=this;console.log("updating card "+this.cardWrapper.id),this.axios.get("/1/model/cardWrapperAddition/"+this.cardWrapper.id,{params:{inSectionId:this.inSection?this.inSection.id:""}}).then(function(e){t.cardWrapper=e.data.data})},setConsent:function(t){var e=this;this.axios.put("/1/model/cardAddition/"+this.cardWrapper.additionId+"/setConsent",{},{params:{elementType:"CARD_WRAPPER_ADDITION",simpleConsentState:t?"OPENED":"CLOSED"}}).then(function(t){e.update(),e.$emit("updateCards")})},dragStart:function(t){var e={type:"MOVE_CARD",cardWrapperId:this.cardWrapper.id,fromSectionId:this.inSection.id,scope:this.cardWrapper.scope};t.dataTransfer.setData("text/plain",JSON.stringify(e));var a={type:"MOVE_CARD",cardWrapper:this.cardWrapper,fromSection:this.inSection};this.$store.commit("setDraggingElement",a)},cancelDrag:function(){this.$store.commit("setCardDraggingState",!1)}},created:function(){this.cardWrapper=this.cardWrapperInit}},ct=dt,lt=(a("0013"),a("55fe"),Object(h["a"])(ct,n,s,!1,null,"5189e036",null));lt.options.__file="ModelCard.vue";var pt=lt.exports,ut={components:{"app-model-card":pt,"app-model-card-editor":f},props:{cardWrappers:{type:Array,default:function(){return[]}},inSection:{type:Object,default:null},cardsType:{type:String,default:"new"},acceptDrop:{type:Boolean,default:!1},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"}},computed:{isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},cardsContainerClasses:function(){return{"section-card-col-with-nav":"card"===this.cardsType&&this.$store.state.support.expandModelNav&&!this.$store.state.support.windowIsSmall,"section-card-col-no-nav":"card"===this.cardsType&&(!this.$store.state.support.expandModelNav||this.$store.state.support.windowIsSmall),"section-card-par":"card"!==!this.cardsType}},draggingElement:function(){return this.$store.state.support.draggingElement},lastCardWrapper:function(){var t={cardWrapper:this.cardWrappers[this.cardWrappers.length-1]};return t},newCardItems:function(){var t=[];return t.push({text:this.$t("model.CREATE_NEW"),value:"createNew",faIcon:"fa-plus"}),t.push({text:this.$t("model.ADD_EXISTING"),value:"addExisting",faIcon:"fa-plus"}),t},popperOptions:function(){return{placement:"right",modifiers:{preventOverflow:{enabled:!1}}}}},data:function(){return{creatingNewCard:!1,draggingOverCardWrapper:null,draggingOverCreateCard:!1,draggingOverCardWrapperBefore:!1,draggingOverCardWrapperAfter:!1,resetIntervalId:0}},methods:{cardCreated:function(){this.creatingNewCard=!1,this.$emit("updateCards")},addExisting:function(){this.$emit("create-card",{addExistingInit:!0})},draggingOver:function(t,e){var a=this;if(this.acceptDrop)if(this.draggingOverCreateCard=null==e,"COMMON"===this.draggingElement.cardWrapper.scope&&"COMMON"===e.scope||"COMMON"!==this.draggingElement.cardWrapper.scope||null==this.draggingElement){this.draggingOverCardWrapper=e;var i=(t.screenY-t.currentTarget.getBoundingClientRect().top-100)/t.currentTarget.offsetHeight;i<.5?"COMMON"!==this.draggingElement.cardWrapper.scope&&"COMMON"===e.scope?(this.draggingOverCardWrapper=null,this.draggingOverCardWrapperBefore=!1,this.draggingOverCardWrapperAfter=!1):(this.draggingOverCardWrapperBefore=!0,this.draggingOverCardWrapperAfter=!1):(this.draggingOverCardWrapperBefore=!1,this.draggingOverCardWrapperAfter=!0),clearTimeout(this.resetIntervalId),this.resetIntervalId=setTimeout(function(){a.draggingOverCardWrapper=null,a.draggingOverCreateCard=!1},500)}else this.draggingOverCardWrapper=null},isDraggingOver:function(t){return!!this.acceptDrop&&(!!this.draggingOverCardWrapper&&this.draggingOverCardWrapper.id===t.id)},cardDroped:function(t,e){var a=this;if(this.acceptDrop){var i=JSON.parse(e.dataTransfer.getData("text/plain"));if("MOVE_CARD"===i.type){var r=!1;r=!e.ctrlKey&&""!==i.fromSectionId,r?(console.log("moving card "+i.cardWrapperId+" from "+i.fromSectionId+" to "+this.inSection.id),this.axios.put("/1/model/section/"+i.fromSectionId+"/moveCard/"+i.cardWrapperId,{},{params:{onSectionId:this.inSection.id,onCardWrapperId:t,isBefore:this.draggingOverCardWrapperBefore}}).then(function(t){a.$store.commit("triggerUpdateSectionCards")})):(console.log("adding card "+i.cardWrapperId+" to "+this.inSection.id),this.axios.put("/1/model/section/"+this.inSection.id+"/cardWrapper/"+i.cardWrapperId,{},{params:{onCardWrapperId:t,isBefore:this.draggingOverCardWrapperBefore,scope:i.scope}}).then(function(t){a.$store.commit("triggerUpdateSectionCards")}))}this.$store.commit("setDraggingElement",null)}}},watch:{"inSection.id":function(){this.$route.query.createCard===this.inSection.id&&this.$emit("createNew",this.cardWrappers[this.cardWrappers.length-1])}}},ht=ut,gt=(a("c68a"),Object(h["a"])(ht,i,r,!1,null,"5b5d4a91",null));gt.options.__file="ModelCardsContainer.vue";e["a"]=gt.exports},"1d8c9":function(t,e,a){},"354b":function(t,e,a){},"4d72":function(t,e,a){"use strict";var i=a("14f4"),r=a.n(i);r.a},"4f27":function(t,e,a){"use strict";var i=a("7906"),r=a.n(i);r.a},5178:function(t,e,a){},"53f4":function(t,e,a){},5535:function(t,e,a){},"55fe":function(t,e,a){"use strict";var i=a("fadc"),r=a.n(i);r.a},"587c":function(t,e,a){},"5bc9":function(t,e,a){"use strict";var i=a("90ab"),r=a.n(i);r.a},"5ff3":function(t,e,a){},7103:function(t,e,a){},7906:function(t,e,a){},"7bab":function(t,e,a){},"8a97":function(t,e,a){"use strict";var i=a("587c"),r=a.n(i);r.a},"8ba1":function(t,e,a){"use strict";var i=a("f177"),r=a.n(i);r.a},"90ab":function(t,e,a){},9559:function(t,e,a){"use strict";var i=a("354b"),r=a.n(i);r.a},"9e28":function(t,e,a){t.exports=a.p+"img/doc-icon.edaccf5c.svg"},a8de:function(t,e,a){"use strict";var i=a("7bab"),r=a.n(i);r.a},bca5:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.section?a("div",{ref:"sectionContainer",staticClass:"section-container",attrs:{id:t.section.id}},[a("div",{staticClass:"slider-container"},[a("transition",{attrs:{name:"slideDownUp"}},[t.showNewCardModal?a("app-model-card-modal",{attrs:{isNew:!0,inSectionId:t.section.id,inSectionTitle:t.section.title,addExistingInit:t.addExistingInit},on:{close:function(e){t.showNewCardModal=!1},updateCards:function(e){t.updateCards()}}}):t._e()],1)],1),t.nestedIn.length>0&&t.section.subElementsLoaded||t.showThisTitle?a("div",{staticClass:"w3-row title-row",class:{"card-container-doc":"doc"===t.cardsType}},[a("div",{staticClass:"w3-row blue-color title-text"},[t._l(t.nestedIn.slice(1,t.nestedIn.length),function(e){return a("div",{staticClass:"w3-left"},[t.addSectionLinks?a("router-link",{staticClass:"w3-left",attrs:{to:{name:"ModelSectionContent",params:{sectionId:e.id}}}},[t._v("\n           "+t._s(e.title)+"\n        ")]):a("div",{staticClass:"w3-left"},[a("span",{domProps:{innerHTML:t._s(t.headerOpenTag+e.title+t.headerCloseTag)}})]),a("div",{staticClass:"w3-left chevron-container"},[t.isDocView?a("span",{domProps:{innerHTML:t._s(t.headerOpenTag+t.faRawHtml+t.headerCloseTag)}}):a("span",{domProps:{innerHTML:t._s(t.faRawHtml)}})])],1)}),a("div",{staticClass:"w3-left"},[t.addSectionLinks?a("router-link",{attrs:{to:{name:"ModelSectionContent",params:{sectionId:t.section.id}}}},[a("b",[t._v(t._s(t.section.title))])]):a("div",{},[a("span",{domProps:{innerHTML:t._s(t.headerOpenTag+"<b>"+t.section.title+"</b>"+t.headerCloseTag)}})])],1)],2),!t.readOnly&&t.section.inSections.length>1?a("div",{staticClass:"w3-row"},[t._m(0),a("div",{staticClass:"w3-left"},[a("app-in-model-sections-tags",{attrs:{inModelSections:t.section.inSections,hideSectionId:t.inSection.id}})],1)]):t._e(),t.hasDescription?a("div",{staticClass:"w3-row description-text light-grey"},[a("vue-markdown",{staticClass:"marked-text",attrs:{source:t.section.description,anchorAttributes:{target:"_blank"}}})],1):t._e()]):t._e(),a("div",{staticClass:"w3-row"},[a("app-model-cards-container",{attrs:{cardWrappers:t.sortedCards,cardsType:t.cardsType,inSection:t.section,acceptDrop:!0,cardRouteName:t.cardRouteName,hideCardControls:t.readOnly},on:{updateCards:function(e){t.updateCards()},createNew:t.createNew,edit:t.edit,"create-card":function(e){t.createCardWithModal(e)}}})],1),a("div",{staticClass:"w3-row"},t._l(t.sortedSubsections,function(e){return a("div",{key:e.id,staticClass:"subsection-container"},[a("app-model-section",{attrs:{section:e,inSection:t.section,cardsType:t.cardsType,nestedIn:t.nestedIn.concat([t.section]),cardRouteName:t.cardRouteName,readOnly:t.readOnly,showPrivate:t.showPrivate,showShared:t.showShared,showCommon:t.showCommon},on:{updateCards:function(e){t.updateCards()}}})],1)}))]):t._e()},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w3-left w3-margin-right"},[a("i",[t._v("also in")])])}],n=(a("20d6"),a("cadf"),a("551c"),a("097d"),a("1a80")),s=a("d5b4"),o=a("cb70"),d={name:"app-model-section",components:{"app-model-cards-container":n["a"],"app-in-model-sections-tags":s["a"]},props:{section:{type:Object,default:null},showThisTitle:{type:Boolean,default:!1},nestedIn:{type:Array,default:function(){return[]}},inSection:{type:Object,default:null},cardsType:{type:String,default:"card"},hideCardControls:{type:Boolean,default:!1},cardRouteName:{type:String,default:"ModelSectionCard"},showPrivate:{type:Boolean,default:!0},showShared:{type:Boolean,default:!0},showCommon:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1}},data:function(){return{loaded:!1,showSubsections:!0,showCards:!0,expanded:!0,showCardId:"",expandSubSubsecInit:!1,subscription:null,showNewCardModal:!1,createNewCard:!1,editCard:!1,targetCard:{type:"new",cardWrapper:null},addExistingInit:!1,targetCards:[]}},computed:{nestedLevel:function(){return this.nestedIn.length+1},isDocView:function(){return"doc"===this.cardsType},isReadFriendly:function(){return"ModelSectionReadCard"===this.cardRouteName},addSectionLinks:function(){return!this.isReadFriendly},headerOpenTag:function(){return this.isDocView?"<h"+(this.nestedLevel<6?this.nestedLevel:6)+">":""},headerCloseTag:function(){return"doc"!==this.cardsType?"":"</h"+(this.nestedLevel<6?this.nestedLevel:6)+">"},hasDescription:function(){return!!this.section.description&&""!==this.section.description},sortedCards:function(){var t=this,e=Object(o["b"])(this.section,this.showCommon,this.showShared,this.showPrivate);if(this.createNewCard){var a=e.findIndex(function(e){return e.id===t.targetCard.cardWrapper.id});"before"===this.$store.state.support.createNewCardLocation&&(a-=1),e.splice(a+1,0,this.targetCard),this.createNewCard=!1}if(this.editCard)for(var i in this.targetCards){var r=e.findIndex(function(e){return e.id===t.targetCards[i].cardWrapper.id});this.targetCards[i].type="edit",e[r]=this.targetCards[i]}return e},sortedSubsections:function(){return Object(o["c"])(this.section,this.showCommon,this.showShared,this.showPrivate)},isLoggedAnEditor:function(){return this.$store.getters.isLoggedAnEditor},faRawHtml:function(){return'<i class="fa fa-chevron-right" aria-hidden="true"></i>'}},watch:{"$store.state.support.triggerUpdateSectionCards":function(){this.updateCards()},section:function(){this.subscribeSocket()}},methods:{edit:function(t){if("edit"===t.type){for(var e in this.targetCards)if(JSON.stringify(t)===JSON.stringify(this.targetCards[e])){this.targetCards.splice(e,1);break}}else this.targetCard.cardWrapper=t,this.targetCard.type="edit",this.targetCards.push(JSON.parse(JSON.stringify(this.targetCard)));this.editCard=!0},createNew:function(t){this.targetCard.cardWrapper=t,this.targetCard.type="newCard",this.createNewCard=!0},createCardWithModal:function(t){this.addExistingInit=t.addExistingInit||!1,this.showNewCardModal=!0},updateCards:function(){var t=this;console.log("updating cards"),this.axios.get("/1/model/section/"+this.section.id+"/cardWrappers").then(function(e){"success"===e.data.result&&(t.createNewCard=!1,t.section.cardsWrappersCommon=e.data.data.cardsWrappersCommon,t.section.cardsWrappersPrivate=e.data.data.cardsWrappersPrivate,t.section.cardsWrappersShared=e.data.data.cardsWrappersShared)})},subscribeSocket:function(){var t=this;null===this.subscription&&(this.subscription=this.$store.dispatch("subscribe",{url:"/channel/activity/model/section/"+this.section.id,onMessage:function(e){var a=e.body;console.log("mesage on section: "+t.section.id+" - MSG: "+a),"UPDATE"===a&&t.updateCards()}}))},dragStart:function(t){var e={type:this.dragType,sectionId:this.section.id,fromElementId:this.inElementId};t.dataTransfer.setData("text/plain",JSON.stringify(e))},newCardFromBar:function(){this.showCards=!0,this.$emit("new-card")},newSubsectionFromBar:function(){this.showSubsections=!0,this.$emit("new-subsection")},handleSocket:function(){var t=this;if(this.section){console.log(this.section.id);var e="/channel/activity/model/section/"+this.section.id;this.subscription=this.$store.dispatch("subscribe",{url:e,onMessage:function(e){var a=e.body;"UPDATE"===a&&t.updateCards()}}),setInterval(function(){},1e3)}}},created:function(){this.section&&this.subscribeSocket()},beforeDestroy:function(){this.subscription&&this.$store.dispatch("unsubscribe",this.subscription)}},c=d,l=(a("4f27"),a("8a97"),a("2877")),p=Object(l["a"])(c,i,r,!1,null,"303c8716",null);p.options.__file="ModelSection.vue";e["a"]=p.exports},c335:function(t,e,a){"use strict";var i=a("5178"),r=a.n(i);r.a},c68a:function(t,e,a){"use strict";var i=a("5535"),r=a.n(i);r.a},d5b4:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},t._l(t.inModelSections,function(e){return t.showThisTag(e)?a("div",{key:e.id,staticClass:"w3-left insection-tag-container"},[a("app-model-section-tag",{attrs:{section:e}})],1):t._e()}))},r=[],n=a("ef96"),s={components:{"app-model-section-tag":n["a"]},props:{inModelSections:{type:Array,default:function(){return[]}},hideSectionId:{type:String,default:""}},methods:{showThisTag:function(t){return t.id!==this.hideSectionId}}},o=s,d=(a("da50"),a("2877")),c=Object(d["a"])(o,i,r,!1,null,"593d52b5",null);c.options.__file="InModelSectionsTags.vue";e["a"]=c.exports},da50:function(t,e,a){"use strict";var i=a("53f4"),r=a.n(i);r.a},f130:function(t,e,a){},f177:function(t,e,a){},fadc:function(t,e,a){},fb9b:function(t,e,a){"use strict";var i=a("7103"),r=a.n(i);r.a},ff0c:function(t,e,a){"use strict";var i=a("1d8c9"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-d9f73a80.586d44d0.js.map